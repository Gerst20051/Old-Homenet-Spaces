<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
  <head>
    <title>SCHTASKS</title>
    <link rel="stylesheet" href="../../CSS/COMMANDS.CSS" type="text/css">
  </head>
  <body>
    <a href="../../Index.html">Home</a>
    &gt; <a href="../../INDEXN.HTM#s">Commands N-Z</a>
    &gt; <a href="../INDEXS.HTM#schtasks">Commands S</a>
    <h1>SCHTASKS</h1>

    <hr>
    <a name="Description"></a> <b>Description</b>
    | <a href="#Syntax">Syntax</a>
    | <a href="#Parameters">Parameters</a>
    | <a href="#Switches">Switches</a>
    | <a href="#Related">Related</a>
    | <a href="#Notes">Notes</a>
    | <a href="#Examples">Examples</a>
    | <a href="#Errorlevels">Errorlevels</a>
    | <a href="#Availability">Availability</a>
    <p>Schedules commands and programs to run periodically
    or at a specific time. Adds and removes tasks from the
    schedule, starts and stops tasks on demand, and
    displays and changes scheduled tasks.</p>

    <hr>
    <a name="Syntax"></a> <b>Syntax</b>
    <p>SCHTASKS
    <a href="#SwitchHelp">/?</a></p>

    <p>SCHTASKS
    {<a href="#SwitchChange">/CHANGE</a>
    | <a href="#SwitchCreate">/CREATE</a>
    | <a href="#SwitchDelete">/DELETE</a>
    | <a href="#SwitchEnd">/END</a>
    | <a href="#SwitchQuery">/QUERY</a>}
    | <a href="#SwitchRun">/RUN</a>}
    <a href="#SwitchHelp">/?</a></p>

    <p>SCHTASKS
    <a href="#SwitchChange">/CHANGE</a>
    <a href="#SwitchTn">/TN task_name</a>
    [<a href="#SwitchS">/S computer</a>
     [<a href="#SwitchU">/U [domain\]user</a>
      <a href="#SwitchP">/P password</a>]]
    [<a href="#SwitchTr">/TR task_run</a>]
    [<a href="#SwitchRu">/RU {[domain\]user | "System"}</a>
     <a href="#SwitchRp">/RP password</a>]]</p>

    <p>SCHTASKS
    <a href="#SwitchCreate">/CREATE</a>
    <a href="#SwitchTn">/TN task_name</a>
    <a href="#SwitchTr">/TR task_run</a>
    <a href="#SwitchSc">/SC schedule</a>
    [<a href="#SwitchMo">/MO modifier</a>]
    [<a href="#SwitchD">/D day</a>]
    [<a href="#SwitchM">/M month[,month ...]</a>]
    [<a href="#SwitchI">/I idle_time</a>]
    [<a href="#SwitchSt">/ST start_time</a>]
    [<a href="#SwitchSd">/SD start_date</a>]
    [<a href="#SwitchEd">/ED end_date</a>]
    [<a href="#SwitchS">/S computer</a>
     [<a href="#SwitchU">/U [domain\]user</a>
      <a href="#SwitchP">/P password</a>]]
    [<a href="#SwitchRu">/RU {[domain\]user | "System"}</a>
     <a href="#SwitchRp">/RP password</a>]]</p>

    <p>SCHTASKS
    <a href="#SwitchDelete">/DELETE</a>
    <a href="#SwitchTn">/TN task_name</a>
    [<a href="#SwitchF">/F</a>]
    [<a href="#SwitchS">/S computer</a>
     [<a href="#SwitchU">/U [domain\]user</a>
      <a href="#SwitchP">/P password</a>]]</p>

    <p>SCHTASKS
    {<a href="#SwitchEnd">/END</a>
    | <a href="#SwitchRun">/RUN</a>}
    <a href="#SwitchTn">/TN task_name</a>
    [<a href="#SwitchS">/S computer</a>
     [<a href="#SwitchU">/U [domain\]user</a>
      <a href="#SwitchP">/P password</a>]]</p>

    <p>SCHTASKS
    [<a href="#SwitchQuery">/QUERY</a>]
    [<a href="#SwitchFo">/FO format</a>]
    [<a href="#SwitchNh">/NH</a>]
    [<a href="#SwitchV">/V</a>]
    [<a href="#SwitchS">/S computer</a>
     [<a href="#SwitchU">/U [domain\]user</a>
      <a href="#SwitchP">/P password</a>]]</p>

    <hr>
    <a name="Parameters"></a> <b>Parameters</b>
    <p>none.</p>

    <hr>
    <a name="Switches"></a> <b>Switches</b>
    <dl>
      <dt><a name="SwitchHelp"></a> /?
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Displays help.</dd>

      <dt><a name="SwitchChange"></a> /CHANGE
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Changes one or more properties of a task.</dd>

      <dt><a name="SwitchCreate"></a> /CREATE
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Creates a new scheduled task.</dd>

      <dt><a name="SwitchD"></a> /D day
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies a day of the week or a day of a month.
      Valid only with a <a href="#SwitchMo">WEEKLY</a> or
      <a href="#SwitchMo">MONTHLY</a> schedule:
        <ul>
          <li><a href="#SwitchMo">WEEKLY</a> Optional. Valid values are
          MON - SUN and * (every day). MON is the default</li>
          <li><a href="#SwitchMo">MONTHLY</a> A value of <b>MON</b> -
          <b>SUN</b> is required when the <a href="#SwitchMo">FIRST</a>,
          <a href="#SwitchMo">SECOND</a>, <a href="#SwitchMo">THIRD</a>,
          <a href="#SwitchMo">FOURTH</a>, or <a href="#SwitchMo">LAST</a>
          modifier is used. A value of <b>1</b> - <b>31</b> is optional and
          is valid only with no modifier or a modifier of the
          <a href="#SwitchMo">1</a> - <a href="#SwitchMo">12</a> type.
          The default is day 1 (the first day of the month)</li>
        </ul>
      </dd>

      <dt><a name="SwitchDelete"></a> /DELETE
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Deletes a scheduled task.</dd>

      <dt><a name="SwitchEd"></a> /ED start_date
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the last date that the task is scheduled
      to run. This switch is optional. It is valid with
      <a href="#SwitchSc">MINUTE</a>, <a href="#SwitchSc">HOURLY</a>,
      <a href="#SwitchSc">DAILY</a>, <a href="#SwitchSc">WEEKLY</a>,
      and <a href="#SwitchSc">MONTHLY</a> schedules.
      By default, schedules have no ending date.</dd>

      <dt><a name="SwitchEnd"></a> /END
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Stops a program started by a task.</dd>

      <dt><a name="SwitchF"></a> /F
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Suppresses the confirmation message.
      The task is deleted without warning.</dd>

      <dt><a name="SwitchFo"></a> /FO format
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the output format:
        <ul>
          <li><b>CSV</b></li>
          <li><b>LIST</b></li>
          <li><b>TABLE</b> the default</li>
        </ul>
      </dd>

      <dt><a name="SwitchI"></a> /I idle_time
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies how many minutes the computer is idle
      before the task starts. Type a whole number from 1 to
      999. Required and valid only with an
      <a href="#SwitchSc">ONIDLE</a> schedule.</dd>

      <dt><a name="SwitchM"></a> /M month[, month ...]
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies a month of the year. Valid values are
      <b>JAN</b> - <b>DEC</b> and <b>*</b> (every month).
      Valid only with a <a href="#SwitchMo">MONTHLY</a> schedule.
      required when <a href="#SwitchMo">LASTDAY</a> is used.
      Otherwise, it is optional and the default value is <b>*</b>
      (every month).</dd>

      <dt><a name="SwitchMo"></a> /MO modifier
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies how often the task runs within its
      schedule type. Required for MONTHLY schedule.
      Optional for MINUTE, HOURLY, DAILY, or WEEKLY schedule.
      The default value is 1:
<pre>
      <u>Type    Modifier  Description</u>
      <b>MINUTE</b>  1 - 1439  The task runs every n minutes.
      <b>HOURLY</b>  1 - 23    The task runs every n hours.
      <b>DAILY</b>   1 - 365   The task runs every n days.
      <b>WEEKLY</b>  1 - 52    The task runs every n weeks.

      <b>MONTHLY</b> 1 - 12    The task runs every n months.
              <b>LASTDAY</b>   The task runs on the last day of the month.
              <b>FIRST</b>
              <b>SECOND</b>
              <b>THIRD</b>
              <b>FOURTH</b>
              <b>LAST</b>      Use with <a href="#SwitchD">/d day</a>
                        to run a task on a particular week and day.
      <u>Type    Modifier  Description</u>
</pre>
      </dd>

      <dt><a name="SwitchNh"></a> /NH
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Omits column headings from the table display.
      Valid with the <a href="#SwitchFo">TABLE</a> and
      <a href="#SwitchFo">CSV</a> output formats.
      </dd>

      <dt><a name="SwitchP"></a> /P password
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the password of the
      <a href="#SwitchU">/u</a> user account.</dd>

      <dt><a name="SwitchQuery"></a> /QUERY
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Displays all tasks scheduled to run on the
      computer, including those scheduled by other users.</dd>

      <dt><a name="SwitchRp"></a> /RP password
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the password of the
      <a href="#SwitchRu">/ru</a> user account.
      If you omit this switch when specifying a user
      account, you will be prompted for the password unless
      the NT Authority\System permissions does not require
      a password.</dd>

      <dt><a name="SwitchRu"></a> /RU {[domain\]user | "System"}
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Runs the tasks with the permission of the specified
      user account. By default, the task runs with the
      permissions of the user logged on to the computer.
<pre>
      <u>Value           Description</u>
      <b>[Domain\]User</b>   Specifies a user account.
      <b>"System" or ""</b>  Specifies the NT Authority\System account,
                      which is used by the operating system.
</pre>
      </dd>

      <dt><a name="SwitchRun"></a> /RUN
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Starts a scheduled task immediately. Ignores the
      schedule, but uses the program file location, user
      account, and password saved in the task to run the
      task immediately.</dd>

      <dt><a name="SwitchS"></a> /S computer
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the name or IP address of a remote
      computer (with or without backslashes).
      The default is the local computer.</dd>

      <dt><a name="SwitchSc"></a> /SC schedule
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the schedule type. Valid values are:
        <ul>
          <li><b>DAILY</b></li>
          <li><b>HOURLY</b></li>
          <li><b>MINUTE</b></li>
          <li><b>MONTHLY</b> Specifies the time unit for the schedule</li>
          <li><b>ONCE</b> The task runs once at a specified date and time</li>
          <li><b>ONIDLE</b> The task runs whenever the system is idle for a
          specified period of time. You can specify a date, or run the task the
          next time the system is idle</li>
          <li><b>ONLOGON</b> The task runs whenever a user (any user) logs on.
          You can specify a date, or run the task the next time the user logs
          on</li>
          <li><b>ONSTART</b> The task runs every time the system starts.  You
          can specify a start date, or run the task the next time the system
          starts</li>
          <li><b>WEEKLY</b></li>
        </ul>
      </dd>

      <dt><a name="SwitchSd"></a> /SD start_date
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the date that the task starts in
      MM/DD/YYYY format. The default value is current date.
      Valid with all schedules, and Required for
      <a href="#SwitchMo">ONCE</a> schedule.</dd>

      <dt><a name="SwitchSt"></a> /ST start_time
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the time of day that the task starts in
      HH:MM:SS 24-hour format. The default value is current
      local time when the command completes. Valid with
      <a href="#SwitchMo">MINUTE</a>, <a href="#SwitchMo">HOURLY</a>,
      <a href="#SwitchMo">DAILY</a>, <a href="#SwitchMo">WEEKLY</a>,
      <a href="#SwitchMo">MONTHLY</a>, and <a href="#SwitchMo">ONCE</a>
      schedules.  Required with a <a href="#SwitchMo">ONCE</a> schedule.</dd>

      <dt><a name="SwitchTn"></a> /TN task_name
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies a name for the task.</dd>
      <dd>Task_name of <b>*</b> can
      <a href="#SwitchDelete">/DELETE</a> ALL scheduled
      tasks on the computer.</dd>

      <dt><a name="SwitchTr"></a> /TR task_run
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Specifies the program or command that the task
      runs. Type the fully qualified path and file name of
      an executable file, script file, or batch file. If
      you omit the path, the file is assumed to be in the
      Systemroot\System32 directory.</dd>

      <dt><a name="SwitchU"></a> /U [domain\]user
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Runs the command with the permissions of the
      specified user account. By default, the command runs
      with the permissions of the user logged on to the
      computer.</dd>

      <dt><a name="SwitchV"></a> /V
      (<a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>)</dt>
      <dd>Adds advanced properties of the tasks to the display.
      <a href="#SwitchQuery">QUERIES</a> should be formatted
      as <a href="#SwitchFo">LIST</a> or
      <a href="#SwitchFo">CSV</a>.</dd>
    </dl>

    <hr>
    <a name="Related"></a> <b>Related</b>
    <p>none.</p>

    <hr>
    <a name="Notes"></a> <b>Notes</b>
    <p>Joachim Proske found an annoying problem. Scheduling a Task
    with a path that includes spaces (IE. C:\Program Files\...)
    may result in a "could not start" as the error message when
    <a href="../../Version/MSWIN/NT2K3.HTM">NT2003</a>
    starts to execute the script. The LONG filename is converted to
    a SHORT filename, but the PATH is not... you need to use the
    SHORT pathname (ie.  C:\PROGRA~1\...).</p>

    <hr>
    <a name="Examples"></a> <b>Examples</b>
    <p>none.</p>

    <hr>
    <a name="Errorlevels"></a> <b>Errorlevels</b>
    <p>none.</p>

    <hr>
    <a name="Availability"></a> <b>Availability</b>
    <dl>
      <dt>External</dt>
      <dd>
        <dl>
          <dt>DOS</dt>
          <dd>
          none
          </dd>
          <dt>Windows</dt>
          <dd>
          none
          </dd>
          <dt>Windows NT</dt>
          <dd>
          <a href="../../Version/MSWIN/NTXP.HTM">NTXP</a>
          <a href="../../Version/MSWIN/NT2K3.HTM">NT2003</a>
          </dd>
        </dl>
      </dd>
    </dl>

    <hr>
    Last Updated: 2005/12/01
    <br>Direct corrections or suggestions to:
    <a href="mailto:rick_lively@yahoo.com">Rick Lively</a>
  </body>
</html>
