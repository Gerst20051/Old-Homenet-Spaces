<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Windows Vista Volume Activation 2.0 Step-By-Step Guide</title>
</head>

</body>
<body bgcolor="#3D6094">

<p><a name="Top">
<img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/WindowsVista3.jpg" width="815" height="92"></a></p>
<h1 align="center"><font size="5">Windows Vista Volume Activation 2.0 Step-By-Step 
Guide</font></h1>
<p><b>Purpose</b></p>
<p>This guide provides planning, deployment, and operational guidance for activating 
volume editions of the Windows&nbsp;Vista operating system.</p>
<p><b>Who Should Use the Volume Activation 2.0 Step-by-Step Guide?</b></p>
<p>This guide is targeted at IT professionals who are responsible for deploying 
and managing Windows Vista deployment.</p>
<h5 style="padding-top: 2px">On This Page</h5>
<table cellpadding="0" cellspacing="0" border="0" style="margin-top: 7px; margin-bottom: 12px">
  <tr valign="top">
    <td><a href="#EXC">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Introduction" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EXC">Introduction</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#ENE">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Planning Guidance" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#ENE">Planning Guidance</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EZAAE">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Deployment Guidance" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EZAAE">Deployment Guidance</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EFDAG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Operational Guidance" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EFDAG">Operational Guidance</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EVPAG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Troubleshooting" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EVPAG">Troubleshooting</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EXZAG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Appendix 1: Resolving Non-Genuine Issues on Computers" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EXZAG">Appendix 1: Resolving Non-Genuine Issues 
    on Computers</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#E3BBG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Appendix 2: Recovery from RFM using Standard User Product Activation Web Page" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#E3BBG">Appendix 2: Recovery from RFM using 
    Standard User Product Activation Web Page</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EAGBG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Appendix 3: Resolving MOM 2003 Installation Issue" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EAGBG">Appendix 3: Resolving MOM 2003 Installation 
    Issue</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EFHBG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Appendix 4: Guidance Worksheet Job-Aid" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EFHBG">Appendix 4: Guidance Worksheet Job-Aid</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EOJBG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Appendix 5: Understanding License States" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EOJBG">Appendix 5: Understanding License States</a></td>
  </tr>
  <tr valign="top">
    <td><a href="#EALBG">
    <img hspace="4" vspace="2" border="0" src="../../../i/sy/a/13.gif" alt="Additional Resources" width="7" height="9"></a></td>
    <td class="onThisPage"><a href="#EALBG">Additional Resources</a></td>
  </tr>
</table>
<a name="EXC"></a>
<h2>Introduction</h2>
<h3>Problem </h3>
<p>Software piracy is a problem that is increasing every year, despite a range of 
efforts to combat it. In May 2006, the Business Software Alliance, a leading software 
industry forum, reported that 35 percent of all software installed worldwide during 
2005 was pirated or unlicensed. Piracy on this scale continues to create great challenges 
for Microsoft Corporation, and affects consumers, partners, and the industry.
</p>
<p>While the financial impact on the software industry and the consumers who are 
defrauded by counterfeit software are serious, there are also impacts that go beyond 
dollars. Many consumers who end up with a counterfeit copy of Microsoft software 
are unwitting victims of a crime. They believe that they purchased a properly licensed 
copy, often have documents to back up the purchase, and yet their copy of Microsoft 
Windows, Microsoft Office, or Windows Server is not properly licensed. In addition, 
counterfeit software is increasingly becoming a vehicle for the distribution of 
viruses and malicious software (also called malware) that can target unsuspecting 
users, potentially exposing them to corruption or loss of personal or business data 
and identity theft. </p>
<p>For these reasons, Microsoft continually invests in technologies and programs 
to help protect consumers and businesses from the risks and hidden costs of counterfeit 
and unlicensed software.</p>
<h3>Volume Activation&nbsp;2.0 Solution</h3>
<p>Volume Activation&nbsp;2.0 is a new requirement in the Windows&nbsp;Vista operating system 
and Windows Server Code Name &quot;Longhorn,&quot; which requires activation of each Windows 
Vista license acquired under a Volume License agreement. When designing and building 
the new volume activation technologies, Microsoft focused on two goals:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Close significant piracy loopholes (Volume License keys represent majority 
    of the keys that are involved in Windows piracy.)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Improve the volume customer experience.</p>
    </td>
  </tr>
</table>
<p>Volume Activation&nbsp;2.0 is designed to help increase protection and to help better 
manage the Volume License keys in managed and non-managed environments as well as 
provide flexible deployment options for customers. The process is transparent for 
end users, and the Volume Activation&nbsp;2.0 solution works in a variety of customer 
environments.</p>
<h4>Benefits of Volume Activation&nbsp;2.0</h4>
<p>Volume Activation&nbsp;2.0 supports centrally managed Volume License keys. The Key 
Management Service (KMS) key used for KMS activation is only installed on the KMS 
host and never on individual computers. The Multiple Activation Key (MAK), although 
resident on the individual computer, is encrypted and kept in a trusted store so 
that users are not exposed to the key and are not able to obtain the key once it 
has been installed on the computer. </p>
<p>Volume Activation&nbsp;2.0 supports a simplified setup and is generally invisible 
to the customers. By default, Volume editions do not require a product key to be 
entered during setup. The computer must be activated during an automatic 30-day 
grace period.</p>
<p>System Administrators can count KMS activations using standard system management 
software, for example, Microsoft Operations Manager (MOM) and others in the future. 
Windows Management Infrastructure (WMI), extensive event logging, and built-in Application 
Programming Interfaces (APIs) may provide a wealth of detail about installed licenses 
and about the license state and current grace or expiration period of MAK and KMS-activated 
computers.</p>
<p>Volume Activation&nbsp;2.0 also may provide enhanced security through frequent background 
validations for Genuine modules. This is currently limited to critical software, 
but may be expanded greatly over time.</p>
<h3>Volume Activation 2.0 Overview</h3>
<p>Volume Activation 2.0 provides a simple and security-enhanced activation experience 
for enterprise customers, while addressing issues associated with Volume License 
keys in the previous versions of Windows and may reduce risks of leakage to both 
Microsoft and its customers. Volume Activation 2.0 provides system administrators 
the ability to centrally manage and protect product keys, in addition to several 
flexible deployment options to activate the computers in the environment regardless 
of the size of the environment. In the future, Volume Activation 2.0 will also provide 
the basis for an easy-to-use, comprehensive, integrated activation process that 
will support both Microsoft and third-party applications. Volume Activation 2.0 
is also the starting point for a strong software asset management system that will 
deliver immediate and future benefits.</p>
<p>Volume Activation 2.0 provides customers with two types of keys and three methods 
of activation. Customers are free to use any or all of the options, constrained 
only by their organization’s needs and network infrastructure. </p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Multiple Activation Key (MAK)</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>MAK Proxy Activation</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>MAK Independent Activation</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Key Management Service (KMS) Key</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>KMS Activation</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div style="margin-top: 3px; margin-bottom: 10px">
  <a href="#top">
  <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
  of page</a></div>
<a name="ENE"></a>
<h2>Planning Guidance</h2>
<p>This section of the <i>Volume Activation&nbsp;2.0</i>&nbsp;<i>Step-by-Step Guide</i> provides 
guidance on planning and determining the appropriate Volume Activation 2.0 options 
for their environment. The process consists of the following four steps:</p>
<table cellpadding="0" cellspacing="0" border="0" class="numberedList">
  <tr valign="top">
    <td class="listNumber" nowrap align="right">
    <p>1.</p>
    </td>
    <td>
    <p>Prepare</p>
    </td>
  </tr>
  <tr valign="top">
    <td class="listNumber" nowrap align="right">
    <p>2.</p>
    </td>
    <td>
    <p>Map Computers to Activation Solutions</p>
    </td>
  </tr>
  <tr valign="top">
    <td class="listNumber" nowrap align="right">
    <p>3.</p>
    </td>
    <td>
    <p>Plan monitoring and reporting</p>
    </td>
  </tr>
  <tr valign="top">
    <td class="listNumber" nowrap align="right">
    <p>4.</p>
    </td>
    <td>
    <p>Plan Support</p>
    <p>
    <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act01.gif" alt="Planning Guidance" width="336" height="50"><br>
    <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact01_big.gif" target="_blank">
    See full-sized image</a></p>
    </td>
  </tr>
</table>
<h3>Prepare</h3>
<p>This first step of selecting an appropriate Volume Activation&nbsp;2.0 option involves 
considering the following:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Product activation types</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Target environment considerations</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>User connectivity considerations</p>
    </td>
  </tr>
</table>
<h4>Product Activation Types</h4>
<p>There are three basic types of activation for Windows Vista:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Volume</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>OEM</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Retail</p>
    </td>
  </tr>
</table>
<p>The following sections provide details on each of these types of activation.</p>
<p>More details about activation for Windows Server “Longhorn” will be released 
in the coming months and for other products in the coming years.</p>
<h5>Volume Activation 2.0</h5>
<p>As discussed earlier, Volume Activation&nbsp;2.0 provides customers with the following 
two types of keys and three methods of activation. </p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Multiple Activation Key (MAK)</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>MAK Proxy Activation</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>MAK Independent Activation</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Key Management Service (KMS) Key</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>KMS Activation</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<p>Customers are free to use any or all of the options, constrained only by the 
needs of their organization and its network infrastructure.</p>
<h5>Multiple Activation Key </h5>
<p>MAK activation uses a technology similar to that in use with MSDN Universal and 
Microsoft Action Pack subscriptions. Each product key can activate a specific number 
of computers. If the use of volume-licensed media is not controlled, excessive activations 
result in depletion of the activation pool. MAKs are activation keys. They are not 
used to install Windows but rather to activate it after installation. You can use 
them to activate any volume edition of Windows Vista.</p>
<p>A MAK is used to activate each system under MAK management. Activation can be 
performed over the Internet or by telephone. As each computer contacts Microsoft’s 
activation servers, the activation pool is reduced. You can check the number of 
remaining activations from the Microsoft Licensing Web sites and request additional 
activations by contacting the Microsoft Activation Call Center.</p>
<p>There are two ways to activate computers using MAK:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>MAK Proxy Activation:</b> Is a solution that enables a centralized activation 
    request on behalf of multiple desktops with one connection to Microsoft. MAK 
    Proxy Activation will be available in the solution code name Volume Activation 
    Management Tool (VAMT) which is currently under development with expected availability 
    in 2007.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>MAK Independent Activation:</b> Requires that each desktop independently 
    connects and activates against Microsoft.</p>
    </td>
  </tr>
</table>
<p>Advantages of MAK activation include the ability to automate key assignment and 
activation and no requirement to periodically renew activation. Additional requirements 
include the need to request more activations when the number of activations passes 
the predetermined limit, the need to manage the installation of MAKs (automated 
by Business Desktop Deployment (BDD) 2007), the requirement for reactivation when 
significant hardware changes occur, and the potential need to manually activate 
systems using a telephone when no Internet connection is available.</p>
<h5>Key Management Service (KMS) Key </h5>
<p>Key Management Service (KMS) enables organizations to perform local activations 
for computers in a managed environment without connecting to Microsoft individually. 
A KMS Key is used to enable the Key Management Service on a machine controlled by 
an organization’s system administrator. KMS usage is targeted for managed environments 
where more than 25 computers are consistently connected to the organization’s network. 
Computers running Windows Vista activate by connecting to a central Windows Vista 
computer running the KMS service. </p>
<p>After initializing KMS, the KMS activation infrastructure is self-maintaining. 
Users can install a KMS key and enable the KMS service on Windows Vista systems. 
The KMS service can easily be co-hosted with other services, and it does not require 
any additional software for downloading or installing. Windows Server 2003 KMS service 
for Volume Activation 2.0 is currently under development with expected availability 
in 2007. A single KMS host can support hundreds of thousands of KMS clients. It 
is expected that most organizations will be able to operate with just two KMS hosts 
for their entire infrastructure (one main KMS host and one backup host for redundancy).
</p>
<p>A KMS host must have at least 25 physical Windows Vista clients connected to 
it before any of them will activate.&nbsp;&nbsp;Systems operating in virtual machine (VM) 
environments can also be activated using KMS, but they do not contribute to the 
system count.</p>
<p>Clients must renew their activation by connecting to the KMS Host at least once 
every 180 days. Clients not yet activated will attempt to connect with the KMS host 
every two hours (value configurable). Once activated, they will attempt to connect 
to the KMS host every seven days (value configurable) and if successful will renew 
their 180-day activation life span. Clients locate the KMS host using one of the 
two methods: </p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Auto-Discovery</b>, in which a KMS client uses domain name service records 
    to automatically locate a local KMS host.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Direct connection</b>, where a system administrator specifies the KMS 
    host location and communication port.</p>
    </td>
  </tr>
</table>
<p>Clients have a 30-day grace period to complete activation. Clients not activated 
within this time period will go into Reduced Functionality Mode (RFM).</p>
<p>As mentioned above, KMS clients activated with KMS periodically try to renew 
their activation. If they are unable to connect to a KMS host for more than 180 
days, they enter a 30-day grace period, after which they enter RFM until a connection 
can be made with a KMS host, or until a MAK is installed and the system is activated 
online or via telephone. This feature prevents computers that have been removed 
from the organization from functioning indefinitely without adequate license coverage.</p>
<h5>OEM Activation 2.0</h5>
<p>OEM Activation 2.0 can be a valuable component in your overall activation strategy. 
Advantages of using OEM SKUs and OEM Activation 2.0 include permanent out of the 
box activation and the ability for customers to request custom media images from 
their OEM manufacturer. Volume license media can be preinstalled but must be activated 
by either MAK or KMS.</p>
<h5>Retail Activation</h5>
<p>Like MAK activation, a computer installed with retail versions of Windows Vista 
must be activated online or over telephone with Microsoft. Each installation of 
Windows Vista requires a separate product key. Retail versions of Windows Vista 
cannot use a KMS for activation purposes.</p>
<h4>Target Environment Considerations</h4>
<p>For each target environment where Windows Vista will be deployed, determine the 
current infrastructure capabilities. Some common questions to answer are:</p>
<table cellspacing="0" class="dataTable" id="EFAAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEHAAC" width="33%">Questions</td>
      <td id="colELAAC" width="67%" style="
              border-right: solid 1px #CCCCCC
            ">Considerations</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">How many computers will be deployed in the target network?
    </p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">KMS requires a minimum of 25 computers connected to the 
    KMS host before Windows Vista client computers can be activated.</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Does the network support TCP/IP connectivity?</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">KMS activation requires TCP/IP connectivity (port TCP/1688 
    default). A KMS activation request and response takes approximately 450 bytes. 
    Consider the impact of periodic activation for slow and/or high-latency links.</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Do computers in the target environment have Internet connectivity?</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">For automatic MAK Independent Activation, each computer 
    requires connectivity to the Internet. </p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Does the current Domain Name System (DNS) service support 
    SRV records and DDNS?</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p>Dynamic DNS and SRV record support are required for the default auto-publishing 
    and auto-discovery functionality used by KMS. Both Microsoft Windows&nbsp;2000 or 
    later DNS and BIND 8.x or newer fully support these features. </p>
    <p>Manual configuration of DNS for KMS support is detailed later in this guide.</p>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 1: Infrastructure Analysis Questions</b></p>
<p>For a target environment that has TCP/IP connectivity to a hub location and can 
support the KMS bandwidth requirements, a centralized KMS is a recommended option. 
If the same location does not have TCP/IP connectivity to a hub location but can 
support the necessary computer count (n-count), a local KMS is a viable solution. 
MAK activation is a preferred option for laptops and other target environments that 
cannot meet the n-count. Prior to choosing an activation option, it is important 
to have a clear understanding of user connectivity requirements and infrastructure 
capabilities, along with any business requirements.</p>
<p>The following table lists some general target environment considerations for 
selecting a product activation option. </p>
<table cellspacing="0" class="dataTable" id="EKBAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEMBAC" width="33%">Policy</td>
      <td id="colEQBAC" width="67%" style="
              border-right: solid 1px #CCCCCC
            ">Impact on Activation</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">High security network (no external data transfer allowed)</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p>Data of any kind may not be transferred across network boundary.</p>
    <p>OEM activation may be the best solution in these scenarios.</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Restricted Internet access</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p>Locations from which access to the Internet is restricted.</p>
    <p>KMS or MAK Activation can be used for activation.</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Periodic connectivity</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Computers are required to connect to the organization’s 
    network periodically so that administrators can proactively manage them for 
    updates. Because KMS-based activation is valid for 180 days, these computers 
    need to reconnect or they will fall into Reduced Functionality Mode (RFM).</p>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 2: Security Policy Considerations </b></p>
<p>In addition to the listed considerations, it is equally important to consider 
any organizational policies, for example regarding KMS host sizing or co-hosting.</p>
<h5>KMS Host Sizing</h5>
<p>KMS host processing capacity should not be a limiting factor for virtually any 
size organization. A single KMS host is capable of supporting hundreds of thousands 
of KMS clients, and KMS requests are only a few hundred bytes each. In addition, 
when attempting to activate, the client computers make a KMS request every two hours 
(default) and only once every seven days when activated. Normally, a client computer 
activates with the initial request.</p>
<p>Following are some considerations for planning a KMS host:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>KMS is compute-cycle intensive while actively processing requests. CPU usage 
    can momentarily reach 100 percent on a single-processor computer during request 
    processing. </p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>KMS memory usage can vary from approximately 10 MB to around 25 MB, depending 
    on the number of incoming requests. </p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Network overhead is minimal.</p>
    <p>Less than 250 bytes are sent in each direction for a complete client-KMS 
    exchange, plus TCP session setup and teardown. The only additional network traffic 
    is for auto-discovery, which usually occurs only once per client computer, as 
    long as the same KMS continues to be available for subsequent renewals.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Large organizations may want multiple KMS hosts for load-balancing and redundancy 
    purposes. </p>
    </td>
  </tr>
</table>
<h5>Co-Hosting KMS</h5>
<p>To minimize cost, most organizations prefer to co-host KMS along with other functions. 
KMS is designed to support co-hosting. KMS can easily coexist with common server 
roles, including domain controllers. It has a small resource footprint during normal 
operation, although it can become compute-bound as noted in the previous section.&nbsp;&nbsp;This 
is most likely to occur after a large deployment of KMS clients or if most users 
start their computers in a short period. If CPU consumption is an issue, KMS supports 
a low priority option.</p>
<h4>User Connectivity Considerations</h4>
<p>Assess your environment and identify how your computers are connected to the 
network. Connectivity to the network, Internet access, number of computers that 
regularly connect to the network are some of the important characteristics to identify. 
Some organizations may have a combination of environments where some are connected 
to the corporate network while others are not. In this case, more than one activation 
option is used. These factors are important considerations in selecting an activation 
method.</p>
<p>The following table lists the common types of user connectivity along with the 
characteristics.</p>
<table cellspacing="0" class="dataTable" id="EADAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colECDAC" width="33%">Connectivity Type</td>
      <td id="colEGDAC" width="67%" style="
              border-right: solid 1px #CCCCCC
            ">Characteristics</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Connected</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Computers that are typically connected to the network
    </p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Remote w/Periodic Connectivity </p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Computers that are located “in the field” and have on-demand 
    organizational network connectivity usually through Virtual Private Network 
    (VPN) or by visiting a local office.</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Remote w/Limited Connectivity</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Computers that are located “in the field” and have no 
    direct access to the network, but may have web-based access to organizational 
    resources.</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Disconnected </p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Computers that may never connect to the network or that 
    may connect very infrequently (that is, less than twice a year).</p>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 3: Connectivity Types</b></p>
<p>While KMS activation is a more attractive option for computers with connectivity 
type &#39;Connected&#39; or &#39;Remote w/Periodic Connectivity&#39;, MAK activation is a more logical 
choice for computers with connectivity type &#39;Remote w/Limited Connectivity&#39; or &#39;Disconnected&#39;. 
Choosing an activation option is not as black or white as determining types of user 
connectivity. </p>
<p>
<img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act02.gif" alt="Map Computers to Activation Solutions" width="336" height="50"><br>
<a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact02_big.gif" target="_blank">
See full-sized image</a></p>
<h3>Map Computers to Activation Solutions</h3>
<p>The second step to selecting appropriate activation options is to map computers 
to activation solutions. The goal is to ensure that all computers are associated 
with an activation option. Look at the sample Guidance Worksheet shown in Table 
4 to see how to map your computers to activation solutions. To complete the worksheet, 
you need to determine the following:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The total number of computers that need to be activated using a Volume Activation 
    2.0 method</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The number of computers that will not connect at least once every 180 days 
    (Use MAK activation option.)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The number of computers in environments where there are less than 25 computers 
    (Use MAK activation option.)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The number of computers that will regularly connect to the network (Use KMS 
    activation option.)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The number of computers in disconnected environments where there are more 
    than 25 computers and there is no Internet connectivity (Use KMS activation 
    option.)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The number of computers in disconnected environments where there are less 
    than 25 computers and there is no Internet connectivity (Use MAK activation 
    option.)</p>
    </td>
  </tr>
</table>
<table cellspacing="0" class="dataTable" id="E3EAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colE5EAC" width="59%">Criteria</td>
      <td id="colECFAC" width="23%">Type of Activation</td>
      <td id="colEGFAC" width="18%" style="
              border-right: solid 1px #CCCCCC
            ">Number of Computers</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Total number of computers to be activated</p>
    </td>
    <td>
    <p class="lastInCell">N/A</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">100,000</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Number of computers that will not connect at least once 
    every 180 days</p>
    </td>
    <td>
    <p class="lastInCell">MAK</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">-3,000</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Number of computers in environments where there are less 
    than 25 computers</p>
    </td>
    <td>
    <p class="lastInCell">MAK</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">-1,000</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Number of computers that will regularly connect to the 
    network</p>
    </td>
    <td>
    <p class="lastInCell">KMS</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">-95,000</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Number of computers in disconnected environments where 
    there are more than 25 computers and no Internet connectivity</p>
    </td>
    <td>
    <p class="lastInCell">KMS</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">-250</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Number of computers in disconnected environments where 
    there are less than 25 computers and there no Internet connectivity</p>
    </td>
    <td>
    <p class="lastInCell">MAK</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">-750</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p><b>Remaining computer count should be zero</b></p>
    <p></p>
    </td>
    <td>
    <p class="lastInCell">&nbsp;</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">0</p>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 4: Sample Activation Mapping Worksheet</b></p>
<p>A blank worksheet is available as a job-aid in <a href="#AppenixIV">Appendix 
4</a>.</p>
<p>
<img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act03.gif" alt="Plan Monitoring and Reporting" width="336" height="50"><br>
<a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact03_big.gif" target="_blank">
See full-sized image</a></p>
<h3>Plan Monitoring and Reporting </h3>
<p>It is critical to establish monitoring and reporting for KMS and MAK. For MAKs, 
be sure to include monitoring the number of MAK activations used by viewing the 
Microsoft licensing websites.&nbsp;&nbsp;If your environment can support the requirements 
for KMS (25 computers for Vista activation) then it’s recommended to deploy a KMS 
so that computers will not run in Reduced Functionality Mode.</p>
<p>Refer to the following sections to set up reporting in the environment for Volume 
Activation 2.0:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>KMS MOM Pack (This may be available in Q1 2007) – provides KMS Management 
    and sample reports for KMS activation. See <a href="#KMSActivityReporting">KMS 
    Activity Reporting</a> for descriptions.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Activation reporting through various system management tools will be available 
    soon.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>The file “Volume Activation&nbsp;2.0 Technical Attributes.xls” lists all of the 
    WMI methods, properties, registry keys, and event IDs for product activation.</p>
    </td>
  </tr>
</table>
<p>
<img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act04.gif" alt="Plan Support" width="336" height="50"><br>
<a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact04_big.gif" target="_blank">
See full-sized image</a></p>
<h3>Plan Support </h3>
<p>Create support scripts for the following scenarios to address common Volume Activation 
2.0 issues: </p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><a href="#InstallMAKClients">Steps to convert from KMS to MAK</a>&nbsp;</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><a href="#ConvertclientusingMAKtouseKMS">Steps to convert from MAK to KMS</a></p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><a href="#Troubleshooting">Troubleshooting Activation issues</a>&nbsp;</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><a href="#ResolvingRFM">Recovery from RFM</a>&nbsp;</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><a href="#RecoveryfromnonGenuine">Recovery from non-Genuine</a></p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Information located in the &quot;<a href="#DeploymentGuidance">Deployment Guidance</a>&quot; 
    section later in this guide may assist in developing the script. Additional 
    items to consider are:</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Training to bring support staff up to date on Volume Activation 2.0</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Escalation management to ensure issues are raised to trained personnel</p>
    </td>
  </tr>
</table>
<h3>Deployment Example</h3>
<h4>Deployment Example for MAK Independent Activation and KMS Activation</h4>
<p>Many enterprises have networks that are separated into multiple security zones. 
This can present a problem to a system administrator when activating Windows Vista. 
Fortunately, there are several options when deploying Windows Vista in a heterogeneous 
environment. </p>
<p>The following figure shows the example of a potential network configuration using 
MAK Independent activation and KMS activation. Note that this example is intended 
for illustration purposes only to show key scenarios. </p>
<div style="
          width: 336px
        ">
  <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act05.gif" alt="Figure 1: Network configuration using MAK and KMS" width="336" height="243"><br>
  <p class="figureCaption"><b>Figure 1: Network configuration using MAK and KMS</b><br>
  <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact05_big.gif" target="_blank">
  See full-sized image</a></p>
  <div class="figureRule">
  </div>
</div>
<p>In this example, the enterprise has computers in the following different scenarios:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Core network:</b> The core network has redundant KMS hosts. All computers 
    in the main corporate network query DNS for the KMS SRV record and activate 
    themselves after contacting the KMS service running on one of these computers. 
    The KMS hosts were activated directly through the Internet.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Secure zone:</b> Many enterprises have secure zones that are carved out 
    of the corporate network by installing a firewall to block all traffic between 
    the secure zone and the rest of the network. To allow these computers to activate 
    using the corporate KMS using RPC over TCP/IP, the network administrator has 
    to allow 1688/TCP outbound from the secure zone and allow RPC reply back in.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Isolated lab:</b> In the isolated lab scenario, corporate security policy 
    does not allow any traffic between computers in the isolated lab and the rest 
    of the corporate network. This could be through a firewall that blocks all, 
    but a very limited number of ports or where there is no network connectivity 
    at all. Because the lab has more than 25 computers, users can deploy a KMS service 
    to one Windows Vista computer in the lab. All computers in the lab will then 
    simply activate using the local KMS host. The KMS host itself is activated by 
    calling Microsoft and getting the confirmation ID (CID).</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Disconnected computers:</b> Computers that are not on the corporate network 
    and/or are in a lab that has less than 25 computers must activate using MAK. 
    If a computer requires occasional connectivity to the Internet (for example, 
    the laptop of a traveling salesperson), it can activate against Microsoft directly. 
    The computer needs connectivity to the Internet only once (to activate) and 
    will not need to be reactivated unless there is a major change in the hardware. 
    If a computer is in a lab and has no network connectivity at all, it can activate 
    against Microsoft over a telephone the same way the KMS host is activated in 
    the isolated lab scenario. </p>
    </td>
  </tr>
</table>
<h4>Deployment Example for MAK Proxy Activation </h4>
<p>There are some customers who may not want to use KMS. This section covers the 
example of an enterprise using a MAK proxy activation tool codename “Volume Activation 
Management Tool (VAMT)” to perform all activations for Windows Vista volume editions.</p>
<p>The following figure shows the example of a potential network configuration using 
MAK and VAMT. Note that this example is intended for illustration purposes only 
to show all key scenarios. </p>
<div style="
          width: 336px
        ">
  <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act06.gif" alt="Figure 2: Network configuration using MAK and VAMT" width="336" height="262"><br>
  <p class="figureCaption"><b>Figure 2: Network configuration using MAK and VAMT</b><br>
  <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact06_big.gif" target="_blank">
  See full-sized image</a></p>
  <div class="figureRule">
  </div>
</div>
<p>The figure shows computers in the following scenarios:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Core network:</b> In the core network scenario, the VAMT is deployed to 
    a computer that can access the Internet. The administrator can perform an “Add 
    Machine” function against the Active Directory domain or workgroups to find 
    computers on the network. After discovering the computers and the returned status, 
    the administrator can perform either MAK independent activation or MAK proxy 
    activation.</p>
    <p>A MAK independent activation installs a MAK on a client computer and requests 
    activation against Microsoft servers over the Internet. A MAK proxy activation 
    installs a MAK on a client computer, obtains the installation ID (IID), sends 
    the IID to Microsoft on behalf of the client, and obtains a confirmation ID 
    (CID) that the tool activates the client by installing the corresponding CID.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Secure zone: </b>In this scenario, the tool can activate computers using 
    MAK proxy activation. This assumes that the clients in the secure zone do not 
    have Internet access. The following two key issues need to be addressed:</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>The computers must be discoverable (through Active Directory directory 
        service or Workgroups).</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>The tool has to make a call to the WMI services on the computer to get 
        status and install MAKs and CIDs.</p>
        <p>This requires the firewall to be configured to allow DCOM RPC traffic 
        through it. For more details on this, see &quot;How to configure RPC dynamic 
        port allocation to work with firewalls&quot; at the following URL:<br>
        <a href="http://support.microsoft.com/?kbid=154596" target="_blank">http://support.microsoft.com/?kbid=154596</a></p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Isolated lab: </b>In the isolated lab scenario, the tool is hosted inside 
    the isolated lab. The tool performs discovery, obtains status, installs a MAK, 
    and obtains IID on all computers in the lab. The tool then exports the list 
    of computers to a file on removable media. The administrator imports the machine 
    data onto a computer running the tool in the core network. Once this is done, 
    the tool sends the IIDs to Microsoft and obtains the corresponding CIDs, which 
    the administrator then exports to a file on removable media and takes it back 
    to the isolated lab. Once this data is imported into the tool, the administrator 
    can activate the isolated lab computers by installing the CIDs.</p>
    </td>
  </tr>
</table>
<h3>Media Considerations</h3>
<p>Volume License Product Use Rights require that you have a previous qualifying 
operating system license for each copy of Windows Vista you deploy. The default 
32-bit Volume License media are upgrade-only and are not bootable (64-bit Volume 
License media are not restricted in this way, since there is no supported upgrade 
path). You must first boot a previous version of Windows and then run the setup 
to install Windows Vista. Bootable media is also available on request through your 
Volume License portal.</p>
<h4>Windows Vista Volume License Media</h4>
<table cellspacing="0" class="dataTable" id="EIMAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEKMAC" width="40%">Edition</td>
      <td id="colEOMAC" width="27%">32-bit</td>
      <td id="colESMAC" width="33%" style="
              border-right: solid 1px #CCCCCC
            ">64-bit</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">Windows Vista Business</p>
    </td>
    <td>
    <p class="lastInCell">Upgrade, Full</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Full</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Windows Vista Enterprise</p>
    </td>
    <td>
    <p class="lastInCell">Upgrade, Full</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Full</p>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 5: Windows Vista Volume License Media</b></p>
<h3>Product Key Deployment Considerations</h3>
<p>Volume editions of Windows Vista default to KMS-based activation and do not require 
a product key to be entered during setup. Windows Vista Volume License editions 
use a specific pre-defined setup key in the sources\pid.txt file. MAKs can be specified 
with a variety of methods during deployment or post deployment.</p>
<table cellspacing="0" class="dataTable" id="ELNAC" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colENNAC" width="33%">How to specify Product Key:</td>
      <td id="colERNAC" width="33%">KMS </td>
      <td id="colEVNAC" width="33%" style="
              border-right: solid 1px #CCCCCC
            ">MAK</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">During setup</p>
    </td>
    <td>
    <p class="lastInCell">No key required. Volume license editions (by default) 
    use the product key in \sources\pid.txt for KMS activation</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">No product key can be entered while running manual setup.</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">With an unattend file<sup style="font: 85% Arial">1</sup></p>
    </td>
    <td>
    <p class="lastInCell">No key required. Volume license editions (by default) 
    use the product key in \sources\pid.txt for KMS activation</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">Specify MAK in the “<b>specialize</b>” pass in <b>autounattend.xml</b> 
    (for DVD boot) or <b>unattend.xml</b> (for network share installs) or imageunattend.xml 
    (for WDS installations)</p>
    </td>
  </tr>
  <tr valign="top" class="record">
    <td>
    <p class="lastInCell">With image-based deployment (ImageX.exe or other tools)<sup style="font: 85% Arial">2</sup></p>
    </td>
    <td>
    <p class="lastInCell">No key required. The activation method of the reference 
    image is used.</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <p class="lastInCell">No key required. The activation method of the reference 
    image is used.</p>
    </td>
  </tr>
  <tr valign="top" class="evenRecord">
    <td>
    <p class="lastInCell">Post-operating system installation</p>
    </td>
    <td>
    <p class="lastInCell">No key required. Volume License editions (by default) 
    use the product key in \sources\pid.txt for KMS activation</p>
    </td>
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">Use the Change Product Key option in Control Panel.
        </p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p class="lastInCell">After installation, use slmgr.vbs to install and activate 
        the MAK. This process can be scripted, configured for use by Standard Users 
        and is used by the Business Desktop Deployment (BDD) Solution Accelerator.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p class="lastInCell">The tool codename “Volume Activation and Management 
        Tool (VAMT)” will enable administrators to automate MAK deployment over 
        networks and will be available in 2007.</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" class="tableFootnotes">
  <tr valign="top">
    <td class="footnote" align="right">1</td>
    <td class="footnoteText">You will need to ensure that at least one other setting 
    is configured in the “WindowsPE” pass in the autounattend.xml. For more information, 
    see the Unattended Windows Setup Reference help file in the Windows Automated 
    Installation Kit (Windows AIK). The MAK is stored in clear text in the *.XML 
    file as required by the setup process. During the unattended installation process 
    the unattend.xml file is copied to the target machine (%systemroot%\panther 
    folder) but at the end of setup, the actual ProductKey value in this file is 
    deleted and replaced with “SENSITIVE*DATA*DELETED”.</td>
  </tr>
  <tr valign="top">
    <td class="footnote" align="right">2</td>
    <td class="footnoteText">For more information on using imagex.exe see the Deploy 
    an Image section of the “Getting Started with the Windows Automated Installation 
    Kit (Windows AIK)” guide.</td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Table 6: MAK and KMS Product Key Deployment Options </b></p>
<p>In all deployment scenarios, the product activation timers must be reset by running 
“%systemroot%\system32\sysprep\sysprep /generalize” on the reference system prior 
to distributing the image to users.</p>
<h3>Obtaining Volume License Keys </h3>
<p>Organizations that participate in any Volume License programs can obtain Volume 
License keys from:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>eOpen (<a href="https://eopen.microsoft.com/EN/default.asp" target="_blank">https://eopen.microsoft.com/EN/default.asp</a>)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Microsoft Volume Licensing Services (MVLS) (<a href="https://licensing.microsoft.com/eLicense/L1033/default.asp" target="_blank">https://licensing.microsoft.com/eLicense/L1033/default.asp</a>)</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>Microsoft Activation Call Center - US Customers call 1-888-352-7140.</p>
    <p>For international customers, contact your local support center.</p>
    <p>For phone numbers of activation centers worldwide, go to the following URL:<br>
    <a href="http://www.microsoft.com/licensing/resources/vol/numbers.mspx" target="_blank">
    http://www.microsoft.com/licensing/resources/vol/numbers.mspx</a></p>
    <p>Customers will need to provide their Volume License agreement information 
    and proof of purchase when they call.</p>
    </td>
  </tr>
</table>
<p>By default, KMS keys are limited to ten activations on a maximum of two computers. 
Administrators can obtain an override by calling their local Microsoft Activation 
Call Center.</p>
<p>MAK has an upper limit on the number of activations based on the type of agreement 
that exists between the customer and Microsoft. Customers can request the limit 
to be increased by calling their local Microsoft Activation Call Center.</p>
<p><b>Important note:</b> You are responsible for both the use of keys assigned 
to you and the activation of products using your KMS hosts. </p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>You should not disclose keys to third parties. </p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>You may not provide unsecured access to your KMS hosts over an uncontrolled 
    network such as the Internet.</p>
    </td>
  </tr>
</table>
<div id="#DeploymentGuidance">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="EZAAE"></a>
  <h2>Deployment Guidance</h2>
  <p>The Deployment Guidance section provides step-by-step instructions for activating 
  volume editions of Windows Vista.</p>
  <p><b>For general considerations, read the following section:</b></p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#GeneralConsiderations">General Considerations for Windows Vista</a></p>
      </td>
    </tr>
  </table>
  <p><b>For implementing MAK Activation, read the following sections:</b></p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#MAKActivationOverview">MAK Activation Overview</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#requisitesforMAKActivation">Prerequisites for MAK Activation</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#KnownIssuesforMAKActivation">Known Issues for MAK Activation</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#InstallMAKClients">Steps for Installing and Activating MAK clients</a></p>
      </td>
    </tr>
  </table>
  <p><b>For implementing KMS Activation, read the following sections:</b></p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#KMSActivationOverview">KMS Activation Overview</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#PrerequisitesforKMSPActivation">Prerequisites for KMS Activation</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#KnownIssuesforKMSActivation">Known Issues for KMS Activation</a></p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><a href="#StepsforImplementingConfigDeployingKMS">Steps for Installing, 
      Configuring, and Deploying KMS Activation</a></p>
      </td>
    </tr>
  </table>
  <div id="#GeneralConsiderations">
    <h3>General Considerations for Windows Vista</h3>
    <p>This section provides general considerations on deploying Windows Vista.</p>
    <h4>Tools under Development</h4>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>MAK Proxy Activation will be available in the solution code name Volume 
        Activation Management Tool (VAMT) which is currently under development with 
        expected availability in 2007.</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>Windows Server 2003 KMS service for Volume Activation 2.0 is currently 
        under development with expected availability in 2007.</p>
        </td>
      </tr>
    </table>
    <h4>Administrative Credentials</h4>
    <p>To complete any of the steps, you must be a member of the Administrators 
    group. All script functions must be run from a command prompt using elevated 
    permissions unless activation is enabled for standard users. See
    <a href="#EnableOptionalMAKConfiguration">Enable Standard User MAK Activation</a> 
    section to enable this option.</p>
  </div>
  <div id="#MAKActivationOverview">
    <h3>MAK Activation</h3>
    <p>MAKs are installed on each volume-licensed computer that will activate once 
    with Microsoft over the Internet or telephone. A MAK can be installed on individual 
    computers or can be included in an image that can be bulk-duplicated or provided 
    for download using Windows Deployment Services (WDS). MAKs are recommended for 
    computers that are rarely or never able to connect to the organization’s network. 
    A MAK can be installed on a computer that was set up to use KMS activation, 
    whose activation is at risk of expiring, or that has actually reached the end 
    of its grace period. The 30-day grace period cannot be extended and therefore, 
    you must activate MAK immediately. As a computer nears the end of its activation 
    grace period, pop-up activation notifications are presented to users with increasing 
    frequency, unless pop-up notifications are disabled on the computers.</p>
    <div id="#requisitesforMAKActivation">
      <h4>Prerequisites for MAK Activation</h4>
      <p>To activate MAK on client computers, you must have appropriate Volume License 
      media and access to the Internet or telephone.</p>
    </div>
    <div id="#KnownIssuesforMAKActivation">
      <h4>Known Issues for MAK Activation</h4>
      <p>Prior to MAK activation, it is important to understand the following known 
      issue with MAK activation:</p>
      <p>If a standard user changes a Volume License key, the ProductID registry 
      values will not be updated which primarily affects product support. Microsoft’s 
      Customer Support Services are aware of this issue and will use another method 
      to determine the activation method.</p>
    </div>
    <div id="#InstallMAKClients">
      <h4>Steps for Installing and Activating MAK Clients</h4>
      <p>Steps for installing MAK vary depending on whether you are performing them 
      during or after operating system installation.</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>To install MAK after operating system installation, perform the steps 
          provided in <a href="#ConfigureMAKusingWindowsInterface">Configure a client 
          to use MAK activation using the Windows interface</a> or
          <a href="#ConfigureMAKusingScript">Configure a client to use MAK activation 
          using a script</a>.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>To install MAK during operating system installation, perform the steps 
          provided in <a href="#DeployMAKusingunattend">Configure MAK using unattended 
          setup files</a>.</p>
          </td>
        </tr>
      </table>
      <p>To activate a client computer using MAK activation, perform the steps provided 
      in any one of the following sections:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingInternet">Activate MAK using Internet activation</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingPhone">Activate MAK using Phone activation</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingVAMT">Activate MAK using the tool code name 
          &quot;Volume Activation Management Tool&quot;</a></p>
          </td>
        </tr>
      </table>
      <p>To allow standard users (non-administrator) to change product key, complete 
      the following task:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#EnableOptionalMAKConfiguration">Standard User MAK Activation</a></p>
          </td>
        </tr>
      </table>
      <h5>Install a Multiple Activation Key after Operating System Installation</h5>
      <div id="#ConfigureMAKusingScript">
        <p>Configure a volume-licensed edition to use MAK activation with one of 
        the following procedures:</p>
      </div>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ConfigureMAKusingWindowsInterface">Using the Windows Interface</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ConfigureMAKusingScript">Using a script</a></p>
          </td>
        </tr>
      </table>
      <div id="#ConfigureMAKusingWindowsInterface">
        <p>Note that these procedures also apply to systems that were previously 
        configured to use KMS activation.</p>
      </div>
      <table cellspacing="0" class="dataTable" id="EXFAE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colEZFAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure a client computer to use MAK activation using the Windows 
            interface</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p class="lastInCell">Choose and install the desired volume licensed 
              media. No product key is required during setup. </p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p class="lastInCell">Start the computer and log on with administrator 
              privileges. Open System Properties in Control Panel, by clicking
              <b>Start</b> and then right-clicking <b>Computer</b> and clicking
              <b>Properties</b>.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p>In the <b>Activation</b> section, click <b>Change product key</b>.</p>
              <p>You will be prompted for permission. Click <b>Continue</b>.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>4.</p>
              </td>
              <td>
              <p>In the <b>Change your product key for activation</b><i>&nbsp;</i>dialog 
              box, enter the MAK.</p>
              <p>The computer attempts to activate over the Internet. The next screen 
              will indicate whether it activated successfully or was unable to activate 
              for some reason (usually due to network connectivity).</p>
              <p>If activation was not successful, the computer attempt to retry 
              automatically (The user does not need to be an administrator for automatic 
              activations). To disable automatic activation attempts, change the 
              registry value <b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\</b><br>
              <b>CurrentVersion\SL\Activation\Manual</b> to 1.</p>
              <p><b>Important note: </b>This section contains information about 
              how to modify the registry. Make sure to back up the registry before 
              you modify it. Make sure that you know how to restore the registry 
              if a problem occurs. For more information about how to back up, restore, 
              and modify the registry, click the following article number to view 
              the article in the Microsoft Knowledge Base:
              <a href="http://support.microsoft.com/kb/256986/" target="_blank">
              256986</a> (http://support.microsoft.com/kb/256986/) Description of 
              the Microsoft Windows registry.</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <div style="
          width: 336px
        ">
        <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act07.gif" alt="Figure 3: Change your product key for activation dialog box" width="336" height="251"><br>
        <p class="figureCaption"><b>Figure 3: Change your product key for activation 
        dialog box</b><br>
        <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact07_big.gif" target="_blank">
        See full-sized image</a></p>
        <div class="figureRule">
        </div>
      </div>
      <table cellspacing="0" class="dataTable" id="ECIAE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colEEIAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure a client computer to use MAK activation using a script</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p class="lastInCell">Choose and install the desired volume licensed 
              media. No product key is required during setup. </p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p class="lastInCell">Start the computer and log on with administrator 
              privileges.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p class="lastInCell">Launch a command window (with elevated privileges 
              if not running as administrator).</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>4.</p>
              </td>
              <td>
              <p>Run the following script, using your MAK:<br>
              <i>cscript \windows\system32\slmgr.vbs -ipk &lt;Multiple Activation Key&gt;</i></p>
              <p>The computer attempts to activate over the Internet per the next 
              scheduled interval. To activate immediately, follow the procedure 
              in <a href="#ActivateMAKusingInternet">To activate manually over the 
              Internet using MAK activation using a script</a>.</p>
              <p>If activation was not successful, the computer attempts to retry 
              automatically. To disable automatic activation attempts, change the 
              registry value <b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\</b><br>
              <b>CurrentVersion\SL\Activation\Manual</b> to 1.</p>
              <p><b>Important note</b>: This section contains information about 
              how to modify the registry. Make sure to back up the registry before 
              you modify it. Make sure that you know how to restore the registry 
              if a problem occurs. For more information about how to back up, restore, 
              and modify the registry, click the following article number to view 
              the article in the Microsoft Knowledge Base:
              <a href="http://support.microsoft.com/kb/256986/" target="_blank">
              256986</a> (http://support.microsoft.com/kb/256986/) Description of 
              the Microsoft Windows registry.</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <h5>Install Multiple Activation Key during Operating System Installation</h5>
      <div id="#DeployMAKusingunattend">
        <p>Configure a MAK using unattended setup files using this method:</p>
      </div>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>Use Setup.exe or Windows Deployment Service (WDS) and specify a MAK 
          product key in the “specialize” pass in an <i>unattend.xml</i> on a floppy 
          disk for boot from DVD installation or by running setup /unattend:&lt;<i>path 
          to file</i>&gt; for network share based installation.<b>&nbsp;</b>For more information, 
          see the Unattended Windows Setup Reference help file and the <i>Windows 
          Automated Installation Kit (WAIK) User’s Guide for Windows Vista</i>:
          <a href="http://go.microsoft.com/fwlink/?LinkId=76683" target="_blank">
          http://go.microsoft.com/fwlink/?LinkId=76683</a></p>
          <p>A sample autounattend.xml file to install a MAK is as follows:</p>
          <p><b>Note</b> Some parts of the following code snippet have been displayed 
          in multiple lines only for better readability. These should be entered 
          in a single line.</p>
          <pre class="codeSample">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;

&lt;unattend xmlns=&quot;urn:schemas-microsoft-com:unattend&quot;&gt;

&nbsp;&nbsp;&nbsp; &lt;settings pass=&quot;windowsPE&quot;&gt;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;component name=&quot;Microsoft-Windows-Setup&quot; 

		processorArchitecture=&quot;x86&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; 

		language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; 

		xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot;

		xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		&lt;UserData&gt;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		&lt;AcceptEula&gt;true&lt;/AcceptEula&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		
		&lt;/UserData&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 

	&lt;/component&gt;
&nbsp;&nbsp;&nbsp; 
&lt;/settings&gt;
&nbsp;&nbsp;&nbsp; 
&lt;settings pass=&quot;specialize&quot;&gt;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;component name=&quot;Microsoft-Windows-Shell-Setup&quot; 

		processorArchitecture=&quot;x86&quot; publicKeyToken=&quot;31bf3856ad364e35&quot; 

		language=&quot;neutral&quot; versionScope=&quot;nonSxS&quot; 

		xmlns:wcm=&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot;

		xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
		&lt;ProductKey&gt;MAK Product Key&lt;/ProductKey&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&lt;/component&gt;
&nbsp;&nbsp;&nbsp; 
&lt;/settings&gt;

&lt;cpi:offlineImage cpi:source=&quot;&quot; xmlns:cpi=&quot;urn:schemas-microsoft-com:cpi&quot; /&gt;

&lt;/unattend&gt;</pre>
          </td>
        </tr>
      </table>
      <p><b>Note</b>&nbsp;&nbsp;&nbsp;The MAK is in clear text in the *.XML file as required by 
      the setup process using these methods. During unattended installation process, 
      the file unattend.xml/autounattend.xml is copied to the target computer (%systemroot%\panther 
      folder) but at the end of setup, the actual ProductKey value is deleted and 
      replaced with “SENSITIVE*DATA*DELETED”. &nbsp;</p>
      <h5>Activate MAK Clients</h5>
      <p>You can activate MAK clients using any of the following procedures:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingInternet">Activate MAK using Internet Activation</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingPhone">Activate MAK using Phone Activation</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateMAKusingVAMT">Activate MAK using the tool code name 
          “Volume Activation Management Tool&quot;</a></p>
          </td>
        </tr>
      </table>
      <div id="#ActivateMAKusingInternet">
        <h5>Activating MAK Clients using Internet Activation</h5>
        <p>Activate a computer that uses MAK activation with one of the following 
        procedures:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#ActivateMAKusingInternet">Using the Windows Interface</a></p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#ActivateMAKusingInternet">Using a script</a></p>
            </td>
          </tr>
        </table>
        <table cellspacing="0" class="dataTable" id="EDMAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEFMAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To activate MAK manually using the Windows interface</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p>Open <b>System</b> Properties in Control Panel.</p>
                <p>If you are prompted for permission, click <b>Allow</b>. </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p>Click <b>Click here to activate Windows now</b>.</p>
                <p>This launches the activation wizard. If you are prompted for 
                permission, click <b>Allow</b>.</p>
                <p>If your computer has access to the Internet and is able to activate, 
                Windows reports that the activation was successful. </p>
                <p>If you are unable to activate, the wizard reports the failure 
                and presents additional options, including the ability to activate 
                using the telephone. </p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
        <table cellspacing="0" class="dataTable" id="EGNAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEINAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To activate MAK manually over the Internet using a script</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">Launch a command window (with elevated privileges 
                if not running as Administrator). </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p>Run the following script to perform activation:</p>
                <p><i>cscript \windows\system32\slmgr.vbs –ato</i></p>
                <p>The script will report success or failure with a result code.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
      <div id="#ActivateMAKusingPhone">
        <h5>Activating MAK Clients using Phone Activation</h5>
        <p>Use this procedure to activate computers that are connected to the organizational 
        network and do not have Internet connectivity. </p>
        <p>If you need to perform activation frequently or activate multiple computers, 
        it may be more useful to automate the process by adapting the built-in script 
        (slmgr.vbs).</p>
        <table cellspacing="0" class="dataTable" id="E5NAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEAOAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To activate manually over the telephone with a remote script using 
              MAK activation</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">Launch a command window (with elevated privileges 
                if not running as Administrator). To enable copying from the command 
                window using mouse selection and the ENTER key, ensure that the 
                QuickEdit Mode Edit Option is set.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p class="lastInCell">Obtain the IID from the target computer using 
                the following script:<br>
                <i>cscript \windows\system32\slmgr.vbs &lt;ComputerName&gt; &lt;Username&gt; 
                &lt;Password&gt; –dli</i></p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p class="lastInCell">This will display several sections of license 
                information grouped by Product ID. The section that lists the last 
                five characters of your MAK in Partial Product Key is the one that 
                includes the Product ID and IID required for phone activation. Save 
                both of these values, along with the %<i>COMPUTERNAME</i>%. (Use 
                the set command to find this.)</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>4.</p>
                </td>
                <td>
                <p>Call the automated phone system for your region.</p>
                <p>You can obtain the relevant telephone numbers by using the Find 
                available phone numbers for activation wizard through the software 
                licensing user interface by running <i>slui.exe 4</i> at a command 
                prompt.</p>
                <p>You can use the Interactive Voice Response system to obtain the 
                CID for the target computer. When prompted, provide the corresponding 
                IID from the computer you are activating.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>5.</p>
                </td>
                <td>
                <p class="lastInCell">Activate the target computer (%COMPUTERNAME%) 
                by installing the CID using the following script: <br>
                <i>cscript \windows\system32\slmgr.vbs &lt;ComputerName&gt; &lt;UserName&gt; 
                &lt;Password&gt; –atp &lt;Confirmation ID&gt;</i></p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
      <div id="#ActivateMAKusingVAMT">
        <h5>Activating MAK using the tool code name “Volume Activation Management 
        Tool”</h5>
        <p>Microsoft is currently developing VAMT to provide a cost-effective, batched 
        Internet-based activation alternative to telephone activation. This solution 
        will enable customers to activate a group of connected client computers 
        and will support scenarios where client computers may be disconnected, and 
        only a centrally located computer hosting the tool has access to the Internet 
        or to Microsoft. MAK Proxy Activation will be available in the solution 
        code name Volume Activation Management Tool (VAMT) which is currently under 
        development with expected availability in 2007.</p>
      </div>
      <div id="#EnableOptionalMAKConfiguration">
        <h5>Optional MAK Configuration - Enabling Standard User MAK Activation</h5>
        <p>You can optionally create a registry key to allow a standard user to 
        apply MAK and activate a computer. However, because this lowers security 
        on the computers, it is critical that you understand the heightened risk 
        in allowing standard users to change the licensing status.</p>
        <p>Once you make this change, administrator privileges are no longer required 
        for product activation.</p>
        <table cellspacing="0" class="dataTable" id="EOPAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEQPAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">&nbsp;To enable optional Standard User MAK activation</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">On the client computer, create the following 
                registry key using regedit.exe.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p class="lastInCell">Navigate to <b>HKLM\SOFTWARE\Microsoft\Windows 
                NT\CurrentVersion\SL </b></p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p>Enter the following data:</p>
                <table cellspacing="0" cellpadding="0" border="0">
                  <tr>
                    <td class="listBullet" valign="top">•</td>
                    <td class="listItem">
                    <p class="lastInCell">Value Name: UserOperations</p>
                    </td>
                  </tr>
                  <tr>
                    <td class="listBullet" valign="top">•</td>
                    <td class="listItem">
                    <p class="lastInCell">Type: DWORD</p>
                    </td>
                  </tr>
                  <tr>
                    <td class="listBullet" valign="top">•</td>
                    <td class="listItem">
                    <p class="lastInCell">Value Data: 1</p>
                    </td>
                  </tr>
                </table>
                <p><b>Important</b>&nbsp;<b>note</b>: This section contains information 
                about how to modify the registry. Make sure to back up the registry 
                before you modify it. Make sure that you know how to restore the 
                registry if a problem occurs. For more information about how to 
                back up, restore, and modify the registry, click the following article 
                number to view the article in the Microsoft Knowledge Base:
                <a href="http://support.microsoft.com/kb/256986/" target="_blank">
                256986</a> (http://support.microsoft.com/kb/256986/) &quot;Description 
                of the Microsoft Windows registry.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
        <p>This procedure allows a standard user to switch to a MAK from a KMS client 
        or replace an existing MAK. It also allows a standard user to manually activate 
        the computer.</p>
        <p><b>Note</b>&nbsp;&nbsp;&nbsp;If a standard user changes a volume product key, the ProductID 
        registry values will not be updated this primarily affects product support. 
        The Microsoft Customer Support Services are aware of this issue, and will 
        use another method to determine the activation method.</p>
      </div>
    </div>
  </div>
  <div id="#KMSActivationOverview">
    <h3>KMS Activation</h3>
    <p>Key Management Service (KMS) enables organizations to perform local activations 
    for computers in a managed environment, without the need to connect to Microsoft 
    individually.&nbsp;You can enable KMS functionality on any Windows Vista or Windows 
    Server “Longhorn” computer by installing the KMS key and then activating the 
    computer against Microsoft once, either over the Internet or over the telephone. 
    After initializing KMS, the KMS activation infrastructure is self-maintaining. 
    The&nbsp;KMS service does not require dedicated computers to run it, and can be easily 
    co-hosted with other services.&nbsp;A single KMS host can support hundreds of thousands 
    of KMS clients. It is expected that most organizations will be able to operate 
    with just two KMS hosts for their entire infrastructure (one main KMS host and 
    a backup host for redundancy). Windows Server 2003 KMS service for Volume Activation 
    2.0 is currently under development with expected availability in 2007. In case 
    of significant changes to the hardware on the KMS host, reactivation is a must.</p>
    <p>By default, Windows Vista Business and Windows Vista Enterprise Edition are 
    designed to activate using KMS, without the need for user interaction. Client 
    computers locate the KMS host dynamically using the SRV records found in the 
    DNS or connection information specified in the registry.&nbsp;The client computers 
    use information obtained from the KMS host to self-activate.&nbsp;A KMS host must 
    have at least 25 physical Windows Vista client computers connected to it before 
    any one of them can activate.&nbsp;This is referred to as n value or n-count. Computers 
    that operate in virtual machine (VM) environments can be activated using KMS, 
    but they do not contribute to the count of activated systems. </p>
    <p>Clients that are not activated attempt to connect with the KMS host every 
    two hours (value configurable). This interval can be configured at the KMS host 
    by setting the ActivationInterval (see <a href="#ConfigureKMS">To Configure 
    KMS hosts for KMS Activation</a>).<b>&nbsp;</b>Clients must renew their activation 
    by connecting to the KMS host at least once every 180 days to stay activated.&nbsp;Once 
    activated, the client computers attempt to renew their activation every seven 
    days.&nbsp;This interval can be configured at the KMS host by changing the RenewalInterval 
    (see <a href="#ConfigureKMS">To Configure KMS hosts for KMS Activation</a>). 
    This value is sent to a client each time the client connects. After each successful 
    connection, the expiration is extended out to the full 180 days.&nbsp;</p>
    <p>When a client computer activates against a KMS host, its client machine ID 
    (CMID) is added to a protected table. On successful renewals, the corresponding 
    cached CMID and date stamp are removed from the table. If the client computer 
    does not renew its activation within 30 days, the corresponding CMID is removed 
    from the table and the count is reduced by one. </p>
    <p>Client computers connect to KMS host for activation information using anonymous 
    RPC over TCP using default port 1688.&nbsp;This port information can be configured. 
    The connection is anonymous, enabling workgroup computers to communicate with 
    the KMS host. The firewall and the router network may need to be configured 
    to pass communications for the TCP port that will be used. The client computer 
    establishes a TCP session with the KMS host and then sends a single request 
    packet. The KMS host then responds and the session is closed. The same type 
    of request-response is used for activation requests as well as renewal requests. 
    Both requests and responses are logged by the client in the global application 
    event log (Microsoft Windows Security Licensing SLC events 12288 and 12289, 
    respectively). KMS host logs the requests that it receives from all client computers 
    (Microsoft-Windows-Security-Licensing-SLC event 12290). Note that this KMS event 
    is located in the Applications and Services Logs\Key Management Service event 
    log.</p>
    <div id="#PrerequisitesforKMSPActivation">
      <h4>Prerequisites for KMS Activation</h4>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>You must provide a KMS host with the appropriate Volume License media. 
          KMS clients must also have the appropriate Volume License media to activate 
          against the KMS host.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>KMS clients must be able to access a KMS host. Consider the following:</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>Firewalls and the router network may need to be configured to pass 
          communications for the TCP port that will be used (default 1688).</p>
          <p>If the Windows Firewall is used, no configuration is required on the 
          client computer, because bi-directional TCP sessions that originate from 
          the client computer are automatically allowed. You can configure the TCP 
          port on the client computer or KMS host by using the slmgr.vbs script 
          or setting registry values. You can also set up Group Policy for this. 
          An exception has been added to the Windows Firewall to facilitate opening 
          the default port 1688.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>If IPSec authentication is used to restrict end-to-end communication 
          between computers in the network, you may need to configure one or more 
          KMS hosts as “boundary machines,” that is, disable IPSec authentication 
          in some situations. For example, some of your clients may be in workgroups 
          or you may have domain-based clients that must access a KMS host across 
          an Active Directory forest. The procedure for configuring this is beyond 
          the scope of this guide.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>You may need to configure the Applications and Services Logs\Key Management 
          Service event log on KMS hosts to ensure that it is large enough to accommodate 
          the volume expected in your organization. Each 12290 event, which occurs 
          every time a KMS client connects to the KMS host, requires approximately 
          1,000 bytes. You can set the log size in the <b>Log Properties</b> dialog 
          box.</p>
          </td>
        </tr>
      </table>
    </div>
    <div id="#KnownIssuesforKMSActivation">
      <h4>Known Issues for KMS Activation </h4>
      <p>On using KMS activation, you may encounter the following known issues:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>Volume License Keys support up to 10 activations on two KMS hosts. 
          You can request additional activations through the Microsoft Activation 
          Call Center.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>Changing the Renewal Interval will not take effect on a KMS client 
          until after the change is received by the client and the software licensing 
          service (slsvc) is restarted.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p>Computers running Windows Vista RTM require an RTM KMS to activate; 
          Beta versions of KMS do not support activation of Windows Vista RTM clients.</p>
          </td>
        </tr>
      </table>
    </div>
    <div id="#StepsforImplementingConfigDeployingKMS">
      <h4>Steps for Installing, Configuring, and Deploying KMS Activation</h4>
      <p>To install and configure KMS hosts, perform the steps provided in the following 
      sections:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#InstallKMSMachine">Install KMS hosts</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ConfigureKMS">Configure KMS hosts</a></p>
          </td>
        </tr>
      </table>
      <p>For information and steps to configure KMS publishing to DNS, see the following 
      sections:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#KMSPublishingtoDNSOverview">KMS publishing to DNS overview</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#PrerequisitesforKMSPublishingtoDNS">Prerequisites for KMS 
          Publishing to DNS</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#KnownIssuesforKMSPublishingtoDNS">Known Issues for KMS Publishing 
          to DNS</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#StepsforConfiguringKMSPublishingtoDNS">Steps for Configuring 
          KMS Publishing to DNS</a></p>
          </td>
        </tr>
      </table>
      <p>To install, configure, deploy, and activate KMS clients, perform the steps 
      in the following sections:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#InstallKMSClients">Install KMS clients</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ConfigureKMSclientsforKMSActivation">Configure KMS clients</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#DeployKMSclientsforKMSactivation">Deploy KMS clients</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ActivateKMSclientmanuallyforKMSActivatio">Activate KMS clients 
          manually</a></p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><a href="#ConvertclientusingMAKtouseKMS">Convert a client using MAK 
          Activation to use KMS Activation</a></p>
          </td>
        </tr>
      </table>
      <h5>KMS Hosts</h5>
      <p>This section includes procedures for installing and configuring computers 
      as KMS hosts.</p>
      <h5>Installing KMS Hosts</h5>
      <div id="#InstallKMSMachine">
        <p>Install and activate a computer as a KMS host using the following procedure.</p>
      </div>
      <table cellspacing="0" class="dataTable" id="ELUAE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colENUAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To install KMS hosts for KMS activation</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p class="lastInCell">Choose and install the desired volume licensed 
              media. No product key is required during setup.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p class="lastInCell">Start the computer, log on, and launch a command 
              window with elevated privileges.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p class="lastInCell">Install your KMS key. Do not use the Windows 
              interface for this. Run the following script:<br>
              <i>cscript C:\windows\system32\slmgr.vbs -ipk &lt;Volume License Key&gt;</i></p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>4.</p>
              </td>
              <td>
              <p>Activate the KMS host with Microsoft, either using online activation 
              or telephone activation:<br>
              - For online activation (You must be able to access the Internet from 
              the computer), run the following script:<br>
              <i>cscript C:\windows\system32\slmgr.vbs -ato </i><br>
              - For telephone activation (if you do not have access to the Internet), 
              run the following command and follow the on-screen instructions:
              <br>
              <i>slui.exe 4</i>&nbsp;</p>
              <p>The KMS host is now ready to be used by KMS clients for activation. 
              Additional configuration is optional and will usually not be required.</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <div id="#ConfigureKMS">
        <h5>Configuring KMS Hosts</h5>
        <p>All KMS configurations are optional and should only be used if required 
        for the local environment. All configuration options require that you launch 
        an elevated command prompt and use the built-in script. </p>
        <table cellspacing="0" class="dataTable" id="ETVAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEVVAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure KMS hosts for KMS activation</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">Optionally configure the TCP communications 
                port that the KMS host will use by running:<br>
                <i>cscript C:\windows\system32\slmgr.vbs -sprt &lt;port&gt;</i><br>
                KMS clients that use direct registration have to be configured accordingly. 
                Clients that use auto-discovery will automatically receive and configure 
                the port when they select a KMS host. Remember to restart the slsvc.exe 
                service or restart the computer if you want this to take effect 
                immediately. </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p class="lastInCell">Optionally disable automatic DNS publishing 
                by using the following scripts: <br>
                <i>cscript C:\windows\system32\slmgr.vbs -cdns </i><br>
                Re-enable automatic DNS publishing using the following script:<br>
                <i>cscript C:\windows\system32\slmgr.vbs -sdns</i></p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p class="lastInCell">Optionally set the KMS host to process using 
                lowered scheduler priority: <br>
                <i>cscript C:\windows\system32\slmgr.vbs -cpri </i><br>
                Revert to normal priority:<br>
                <i>cscript C:\windows\system32\slmgr.vbs –spri</i></p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>4.</p>
                </td>
                <td>
                <p class="lastInCell">Optionally set the activation interval that 
                clients will use if not activated (default is 120 minutes). Run 
                the script:<br>
                <i>cscript C:\windows\system32\slmgr.vbs -sai &lt;ActivationInterval&gt;</i></p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>5.</p>
                </td>
                <td>
                <p class="lastInCell">Optionally set the renewal interval that the 
                clients will use for periodically extending their activation expiration 
                (in minutes – default is seven days).</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>6.</p>
                </td>
                <td>
                <p class="lastInCell">Run the following script:<br>
                <i>cscript C:\windows\system32\slmgr.vbs -sri &lt;RenewalInterval&gt;</i></p>
                </td>
              </tr>
            </table>
            <p><b>Note&nbsp;&nbsp;&nbsp;</b>You must restart the KMS service (or the computer) 
            for changes to take effect. To restart the KMS service, you can use 
            the <i>Services</i> snap-in or run these commands in an elevated command 
            window (answer Y when prompted):<br>
            <i>net stop slsvc &amp;&amp; net start slsvc</i></p>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
      <h5>KMS Publishing to DNS</h5>
      <p>KMS publishing allows clients to automatically locate a KMS (called auto-discovery) 
      with zero client configuration. Clients automatically use DNS auto-discovery 
      if they have not been registered to use a specific KMS.</p>
      <div id="#KMSPublishingtoDNSOverview">
        <h5>KMS Publishing to DNS Overview</h5>
        <p>KMS hosts automatically attempt to publish their existence in SRV Resource 
        Records as defined in RFC2782 (<a href="http://www.ietf.org/rfc/rfc2782.txt" target="_blank">http://www.ietf.org/rfc/rfc2782.txt</a>). 
        SRV records can contain multiple entries. These include DNS Address records, 
        which provide the fully qualified domain name for their KMS service providers, 
        as well as attributes, namely priority, port, and weight. KMS only supports 
        the port attribute – priority and weight are ignored. </p>
        <p>KMS publishes its host name (A record) and port in the SRV record. Clients 
        query DNS and retrieve a list of KMS SRV records. They select a KMS host 
        randomly from this list and then attempt to use this information to connect 
        to the KMS. If the connection is successful, the KMS location is cached 
        for subsequent connections. Otherwise, the process repeats until the client 
        is able to connect to a KMS or until the list is exhausted.</p>
        <p>Advantages of using SRV records include:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>Does not require the use of Active Directory</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>Is not limited to Active Directory forests</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>The KMS host’s TCP port number is configurable without having to 
            touch the clients.</p>
            </td>
          </tr>
        </table>
        <p>Site affinity, DNS priority, DNS weight, or other optimizations are not 
        supported by KMS in the Vista release. One way to control which KMS host 
        will be used by clients that use DNS auto-discovery is to use different 
        SRV records for different DNS domains. Alternatively, you would need to 
        use direct KMS registration on each client computer.</p>
        <p>Publishing is enabled by default as soon as a computer is configured 
        as KMS. It attempts to self-publish its location and port in its own DNS 
        domain. Publishing can be disabled by setting the registry value <i>DisableDnsPublishing</i>, 
        as described in <a href="#ConfigureKMS">Configure KMS hosts for KMS Activation</a>. 
        System administrators can also create a list of DNS domains that a KMS host 
        will use to automatically publish their SRV records, see Automatically publish 
        KMS in additional DNS domains.</p>
        <p>For KMS publishing to work, the DNS system must support Dynamic updates 
        (DDNS). It may also be necessary to configure DNS security so that KMS hosts 
        have the required permissions to create or update these records. For more 
        information about DDNS, see
        <a href="http://www.ietf.org/rfc/rfc2136.txt" target="_blank">http://www.ietf.org/rfc/rfc2136.txt</a>. 
        Windows servers support DDNS, starting with Windows&nbsp;2000, as do versions 
        of BIND8.x and later.</p>
        <p>A KMS host will automatically update its SRV entries if the software 
        licensing service (slsvc.exe) detects that the computer name or TCP port 
        has changed during service startup. It will also update them once each day, 
        in order to ensure that they are not automatically removed (scavenged) by 
        the DNS system.</p>
        <p>Not all DNS systems support SRV publishing. In these cases, it is necessary 
        to create or copy the SRV record manually. This can readily be accomplished 
        from a command line or by scripting.</p>
      </div>
      <div id="#PrerequisitesforKMSPublishingtoDNS">
        <h5>Prerequisites for KMS Publishing to DNS</h5>
        <p>To complete this task, ensure that you meet the following requirements:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>The following procedures assume you are using Active Directory and 
            DNS service. Configuring non-Microsoft DNS services, for example, BIND 
            9.x, is outside the scope of this guide. However, it should always be 
            possible to configure SRV records manually.</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>Clients that will need access to KMS hosts across another domain 
            or forest are able to do so. </p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>If you are using Active Directory and Microsoft’s DNS server, you 
            must be a member of the Domain Administrators group, have delegated 
            privileges, or have arranged for the procedures to be carried out by 
            the authority responsible for DNS in your organization. Equivalent requirements 
            apply for non-Microsoft DNS services.</p>
            </td>
          </tr>
        </table>
      </div>
      <div id="#KnownIssuesforKMSPublishingtoDNS">
        <h5>Known Issues for KMS Publishing to DNS</h5>
        <p>KMS publishing has been successfully tested with BIND 9.x. Any server 
        that supports DDNS and SRV resource records per the RFCs should support 
        KMS publishing. Any deployment that is using a non-Microsoft DNS should 
        be fully tested before use in production. </p>
      </div>
      <div id="#StepsforConfiguringKMSPublishingtoDNS">
        <h5>Steps for Configuring KMS Publishing to DNS</h5>
        <p>To configure DNS in Active Directory, complete the following tasks:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#StepsforConfiguringKMSPublishingtoDNS">Configure security 
            for KMS publishing to DNS</a></p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#StepsforConfiguringKMSPublishingtoDNS">Automatically publish 
            KMS in additional domains</a></p>
            </td>
          </tr>
        </table>
        <table cellspacing="0" class="dataTable" id="EZZAE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colE2ZAE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure security for KMS publishing to DNS</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">If you are using only one KMS host, you may 
                not need to configure any permission, because the default behavior 
                is to allow a computer to create an SRV record and then update it. 
                However, if you have more than one KMS hosts (the usual case), the 
                others will be unable to update the SRV record unless SRV default 
                permissions are changed.<br>
                This procedure is an example that has been implemented in the Microsoft 
                environment. It is not the only way to achieve the desired result.<br>
                Detailed steps for each of the tasks are not provided, because they 
                may differ from one organization to another.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p class="lastInCell">If you are a domain administrator and want 
                to delegate the ability to carry out the following steps to others 
                in your organization, optionally create a security group in Active 
                Directory and add the delegates, for example, create a group called 
                Key Management Service Administrators, and then delegate permissions 
                to manage the DNS SRV privileges to this security group. The remainder 
                of this procedure assumes that either a domain administrator or 
                delegate is performing the steps.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p class="lastInCell">Create a global security group in Active Directory 
                that will be used for your KMS hosts, for example, Key Management 
                Service Group.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>4.</p>
                </td>
                <td>
                <p class="lastInCell">Add each of your KMS hosts to this group. 
                They must all be joined to the same domain.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>5.</p>
                </td>
                <td>
                <p class="lastInCell">Once the first KMS host is created, it should 
                create the SRV record. Add each KMS host to this security group.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>6.</p>
                </td>
                <td>
                <p class="lastInCell">If the first computer is unable to create 
                the SRV record, it may be because your organization has changed 
                the default permissions. In this case, you will need to create the 
                SRV record manually with the name _VLMCS._TCP (service name and 
                protocol) for the domain. Set the time-to-live (TTL to 60 minutes).</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>7.</p>
                </td>
                <td>
                <p class="lastInCell">Set the permissions for the SRV group to allow 
                updates by members of the global security group.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
        <table cellspacing="0" class="dataTable" id="EX1AE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colEZ1AE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To automatically publish KMS in additional DNS domains</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">On the KMS host, create the following registry 
                key, using regedit.exe.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p>Navigate to <b>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SL</b></p>
                <p>Value Name: DnsDomainPublishList </p>
                <p>Type: REG_MULTI_SZ</p>
                <p>Value Data: Enter each DNS Domain that KMS should publish to 
                on separate lines.</p>
                <p><b>Important note:</b> This section contains information about 
                how to modify the registry. Make sure to back up the registry before 
                you modify it. Make sure that you know how to restore the registry 
                if a problem occurs. For more information about how to back up, 
                restore, and modify the registry, click the following article number 
                to view the article in the Microsoft Knowledge Base:
                <a href="http://support.microsoft.com/kb/256986/" target="_blank">
                256986</a> (http://support.microsoft.com/kb/256986/) Description 
                of the Microsoft Windows registry.</p>
                <p>It is useful to export the registry key for later use or to import 
                into another KMS host. </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p>Restart the Software Licensing Service and the records should 
                be created immediately.</p>
                <p>The application event log will contain a 12294 event for each 
                successfully published domain and a 12293 event for each unsuccessful 
                domain publishing attempt. </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>4.</p>
                </td>
                <td>
                <p>For the 12293 event, the failure code can be diagnosed by running 
                the following:</p>
                <p>slui.exe 0x2a 0x&lt;error code&gt;</p>
                <p>See <a href="#MappingErrorCodes">Mapping error codes to text 
                messages</a> for example.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
      <h5>KMS Clients</h5>
      <p>This section includes procedures for installing and configuring computers 
      as KMS clients.</p>
      <div id="#InstallKMSClients">
        <p><b>Install KMS clients</b></p>
      </div>
      <p>Install KMS clients using this procedure.</p>
      <table cellspacing="0" class="dataTable" id="EI3AE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colEK3AE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To install KMS clients for KMS activation</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p class="lastInCell">Choose and install the desired volume licensed 
              media. No product key is required during setup.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p class="lastInCell">If you use DNS auto-discovery, no further configuration 
              is required.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p class="lastInCell">For domain-joined computers, the DNS auto-discovery 
              of KMS requires that the DNS zone corresponding to either the primary 
              DNS suffix of the computer or the Active Directory DNS domain contain 
              the SRV resource record for a KMS.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>4.</p>
              </td>
              <td>
              <p class="lastInCell">For workgroup computers, DNS auto-discovery 
              of KMS requires that the DNS zone corresponding to either the primary 
              DNS suffix of the computer or the DNS domain name assigned by DHCP 
              (option 15 per RFC 2132) contain the SRV resource record for a KMS.</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <div id="#ConfigureKMSclientsforKMSActivation">
        <p><b>Configuring KMS Clients</b></p>
      </div>
      <p>Configure KMS clients using this procedure.</p>
      <table cellspacing="0" class="dataTable" id="EA4AE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colEC4AE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure KMS clients for KMS activation</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p>Configuration is only required for KMS clients that will use direct 
              registration with their KMS host. Direct registration overrides DNS 
              auto-discovery. Configuration can be scripted to run remotely and 
              can use Group Policy or logon scripts, assuming that:</p>
              <table cellspacing="0" cellpadding="0" border="0">
                <tr>
                  <td class="listBullet" valign="top">•</td>
                  <td class="listItem">
                  <p class="lastInCell">The required services are enabled on the 
                  computer.</p>
                  </td>
                </tr>
                <tr>
                  <td class="listBullet" valign="top">•</td>
                  <td class="listItem">
                  <p class="lastInCell">The port used for KMS communications is 
                  not blocked in firewalls or routers.</p>
                  </td>
                </tr>
                <tr>
                  <td class="listBullet" valign="top">•</td>
                  <td class="listItem">
                  <p class="lastInCell">Access permissions are set correctly. (All 
                  methods that are implemented in WMI or through the registry require 
                  Administrator privileges unless standard user activation has been 
                  enabled).</p>
                  </td>
                </tr>
              </table>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p>On the KMS client, register the KMS host&#39;s fully qualified domain 
              name (FQDN), for example <i>kms03.site5.contoso.com</i> and, optionally, 
              the TCP port used to communicate with KMS (if you are not using the 
              default):</p>
              <p><i>cscript \windows\system32\slmgr.vbs -skms &lt;KMS_FQDN&gt;[:&lt;port&gt;]</i></p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p>Optionally, the IP or NetBIOS ID (name of the computer) can be 
              used instead of the FQDN.</p>
              <p><i>cscript \windows\system32\slmgr.vbs -skms &lt;IPv4 Address&gt;&lt;:port&gt;</i><br>
              <i>cscript \windows\system32\slmgr.vbs -skms &lt;IPv6 Address&gt;&lt;:port&gt;</i><br>
              <i>cscript \windows\system32\slmgr.vbs -skms &lt;MachineName&gt;&lt;:port&gt;</i></p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>4.</p>
              </td>
              <td>
              <p>To re-enable auto-discovery for a client computer that was registered 
              to use a specific KMS, run the following built-in script:</p>
              <p><i>cscript \windows\system32\slmgr.vbs –ckms</i></p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <div id="#DeployKMSclientsforKMSactivation">
        <p><b>Deploying KMS Clients</b></p>
      </div>
      <p>Deploy KMS clients using this procedure.</p>
      <table cellspacing="0" class="dataTable" id="ET5AE" cellpadding="0">
        <thead>
          <tr valign="top" class="stdHeader">
            <td id="colEV5AE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To deploy KMS clients for KMS activation</td>
          </tr>
        </thead>
        <tr valign="top" class="record">
          <td style="
          border-right: solid 1px #CCCCCC
        ">
          <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>1.</p>
              </td>
              <td>
              <p class="lastInCell">Run <i>sysprep /generalize</i> immediately prior 
              to shutting down your deployment reference image. This resets the 
              activation timer, security identifier, and other important parameters. 
              Resetting the activation timer is important to prevent images from 
              requiring activation immediately after starting first boot. <br>
              Note that running Sysprep does not remove the installed product key 
              and you will not be prompted for a new key during mini-setup.</p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>2.</p>
              </td>
              <td>
              <p class="lastInCell">Use an imaging technology that is compatible 
              with Windows Vista. </p>
              </td>
            </tr>
            <tr valign="top">
              <td class="listNumber" nowrap align="right">
              <p>3.</p>
              </td>
              <td>
              <p class="lastInCell">Deploy using standard techniques such as disk 
              duplication or WDS .</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
      </table>
      <div class="dataTableBottomMargin">
      </div>
      <div id="#ActivateKMSclientmanuallyforKMSActivatio">
        <h5>Activating a KMS Client Manually for KMS Activation</h5>
        <p>You can activate a computer that uses KMS activation with the<i>&nbsp;</i>following 
        procedures. Note that KMS clients attempt to activate automatically at preset 
        intervals. However you may wish to be sure that some clients (mobile clients, 
        for instance) are activated before distributing them. </p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#ActivateKMSclientmanuallyforKMSActivatio">Using the Windows 
            Interface</a></p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><a href="#ActivateKMSclientmanuallyforKMSActivatio">Using a script</a></p>
            </td>
          </tr>
        </table>
        <table cellspacing="0" class="dataTable" id="E36AE" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colE56AE" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To activate a KMS client manually using the Windows interface</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p>Open <b>System</b> properties in Control Panel.</p>
                <p>If you are prompted for permission, click <b>Allow</b>. </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p>Click <b>Click here to activate Windows now</b>.</p>
                <p>This launches the activation wizard. If you are prompted for 
                permission, click <b>Allow</b>.</p>
                <p>If your computer has access to the network and a KMS, Windows 
                reports that activation was successful.</p>
                <p>If the activation fails, the wizard reports the failure. For 
                activation to occur, it is necessary for 25 computers to be present. 
                Until that happens, activation will fail with error code 0xC004F038.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
        <table cellspacing="0" class="dataTable" id="EABAG" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colECBAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To activate a KMS client manually using a script</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">Launch a command window (with elevated privileges 
                if not running as Administrator). </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p>Run the following script to activate:<br>
                <i>cscript \windows\system32\slmgr.vbs –ato</i></p>
                <p>The script reports activation success or failure, along with 
                a result code.</p>
                <p>If you were unable to activate, the wizard will report the failure. 
                For activation to occur, it is necessary for 25 computers to be 
                present. Until that happens, activation will fail with error code 
                0xC004F038.</p>
                </td>
              </tr>
            </table>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
      <div id="#ConvertclientusingMAKtouseKMS">
        <h5>Converting a Client Computer using MAK Activation to use KMS Activation</h5>
        <table cellspacing="0" class="dataTable" id="EYBAG" cellpadding="0">
          <thead>
            <tr valign="top" class="stdHeader">
              <td id="colE1BAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To convert a client computer using MAK activation to use KMS</td>
            </tr>
          </thead>
          <tr valign="top" class="record">
            <td style="
          border-right: solid 1px #CCCCCC
        ">
            <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>1.</p>
                </td>
                <td>
                <p class="lastInCell">Ensure that the computer is connected to the 
                network and can access a KMS host.</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>2.</p>
                </td>
                <td>
                <p class="lastInCell">Launch a command window (with elevated privileges 
                if not running as Administrator). </p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>3.</p>
                </td>
                <td>
                <p>Run the following script to install the setup key as defined 
                in the table (which automatically removes the MAK):</p>
                <p><i>cscript \windows\system32\slmgr.vbs –ipk &lt;setup key&gt;</i></p>
                <p>(Note that the setup key can also be found in <i>sources\pid.txt</i>.)</p>
                <p><b>Edition</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Vista RTM Setup 
                Key (Upgrade)</b></p>
                <p>Windows Vista Business&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XQYF4-QVCMY-YXQRD-9QPV8-3YP9V</p>
                <p>Windows Vista Business N&nbsp;&nbsp;&nbsp;&nbsp;HGBJ9-RWD6M-6HDGW-6T2XD-JQ66F</p>
                <p>Windows Vista Enterprise&nbsp;&nbsp;&nbsp;&nbsp; 3JHG3-Y66GP-B7F3K-JFVX2-VBH7K</p>
                </td>
              </tr>
              <tr valign="top">
                <td class="listNumber" nowrap align="right">
                <p>4.</p>
                </td>
                <td>
                <p>Run the following script to activate the computer: <br>
                <i>cscript \windows\system32\slmgr.vbs –ato</i></p>
                <p>The script reports success or failure, along with a result code.</p>
                </td>
              </tr>
            </table>
            <p><b>Important Note</b>&nbsp;&nbsp;&nbsp;It is important that Windows be activated 
            before the computer is rebooted if more than 30 days have elapsed since 
            initial installation. If it reaches the end of the grace period without 
            activating the computer will be in Reduced Functionality Mode. </p>
            </td>
          </tr>
        </table>
        <div class="dataTableBottomMargin">
        </div>
      </div>
    </div>
  </div>
</div>
<div style="margin-top: 3px; margin-bottom: 10px">
  <a href="#top">
  <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
  of page</a></div>
<a name="EFDAG"></a>
<h2>Operational Guidance</h2>
<p>This section of the Step-by-Step guide provides operational guidance on implementing 
Volume Activation&nbsp;2.0.</p>
<h3>Built-in Scripting Support</h3>
<p>A built-in script is provided to support Volume Activation&nbsp;2.0. This script can 
be run locally on the target system or remotely from another computer. Examples 
provided in this section presume local script use for simplicity. You must supply 
all the parameters shown in brackets for remote use.</p>
<p>The general syntax is: <br>
<i>C:\&gt;cscript C:\windows\system32\slmgr.vbs &lt;ComputerName&gt;&lt;UserName&gt;&lt;Password&gt; 
&lt;Option&gt;</i></p>
<p>You can also run the script using wscript or use the default script engine by 
simply running slmgr.vbs. If the script is invoked without specifying an option, 
usage information will be displayed. If you do not specify user name and password, 
the script takes the credentials of the user that runs the script.</p>
<p><b>Important note: </b>Even for the display-only options, all script functions 
must be run from a command prompt using elevated permissions unless activation is 
enabled for standard users. When running in default configuration as a standard 
user, some data may be missing or incorrect for the display-license option (-dli).&nbsp;&nbsp;To 
accomplish this, right-click the shortcut for the Command Prompt and click Run as 
administrator. </p>
<h3>Remote Scripting Support</h3>
<p>To run the script remotely, make sure that you have the name of the target computer 
as well as the credentials with appropriate privileges. In addition, services and 
ports that are required to support remote use must be appropriately configured.
</p>
<p>To use remote functionality of the slmgr.vbs script, you need to make a few changes 
to the remote system. An exception must be set in the client firewall. To use slmgr.vbs 
remotely with computers in a workgroup, set a registry key to modify the User Access 
Control to allow remote administrative operations. If you plan to use slmgr remote 
functionality across your organization, consider making these changes in your image 
before deployment.</p>
<table cellspacing="0" class="dataTable" id="EZDAG" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colE2DAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure Windows Firewall for remote slmgr.vbs functionality within 
      a single subnet</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">In Control Panel, double-click <b>Security</b>, <b>
        Windows Firewall</b> settings.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p class="lastInCell">Click the <b>Exceptions</b> tab.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p class="lastInCell">Select the <b>Windows Management Instrumentation (WMI)</b> 
        check box.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>4.</p>
        </td>
        <td>
        <p class="lastInCell">Click <b>OK</b>.</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<p><b>Note&nbsp;&nbsp;&nbsp;</b>Windows Firewall Exceptions only apply exceptions originating on 
the local subnet by default. To expand the exception to apply to multiple subnets, 
you need to change the exception settings in the Windows Firewall with Advanced 
Security.</p>
<table cellspacing="0" class="dataTable" id="EDFAG" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEFFAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To configure Windows Firewall for remote slmgr.vbs functionality across 
      multiple subnets </td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">In Control Panel, double-click <b>Administrative Tools</b><i>,</i> 
        and then double-click<i>&nbsp;</i><b>Windows Firewall with Advanced Security</b>.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p>Double-click each of the following three WMI items in turn and make the 
        following changes (a-d):</p>
        <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>1.</p>
            </td>
            <td>
            <p class="lastInCell">Windows Management Instrumentation (ASync-In)</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>2.</p>
            </td>
            <td>
            <p class="lastInCell">Windows Management Instrumentation<i> (DCOM-In)</i></p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>3.</p>
            </td>
            <td>
            <p class="lastInCell">Windows Management Instrumentation<i> (WMI-In)</i></p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p class="lastInCell">On the <b>General</b> tab, select the <b>Allow the 
        connection</b><i>&nbsp;</i>check box.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>4.</p>
        </td>
        <td>
        <p class="lastInCell">On the <b>Scope</b> tab, change the Remote IP Address 
        setting from &quot;Local Subnet&quot; (default) to allow the specific access you need.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>5.</p>
        </td>
        <td>
        <p class="lastInCell">On the <b>Advanced</b> tab, verify selection of all 
        profiles that are applicable to the organizational network.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>6.</p>
        </td>
        <td>
        <p class="lastInCell">Click <b>OK</b>.</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<table cellspacing="0" class="dataTable" id="EIHAG" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEKHAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To create a registry value for remote slmgr.vbs functionality for 
      computers joined in a workgroup</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">On the client computer, create the following registry 
        key using regedit.exe.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p class="lastInCell">Navigate to <b>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\system</b></p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p>Enter the following details:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p class="lastInCell">Value Name: LocalAccountTokenFilterPolicy</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p class="lastInCell">Type: DWORD</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p class="lastInCell">Value Data: 1</p>
            </td>
          </tr>
        </table>
        <p><b>Important note: </b>This section contains information about how to 
        modify the registry. Make sure to back up the registry before you modify 
        it. Make sure that you know how to restore the registry if a problem occurs. 
        For more information about how to back up, restore, and modify the registry, 
        click the following article number to view the article in the Microsoft 
        Knowledge Base:
        <a href="http://support.microsoft.com/kb/256986/" target="_blank">256986</a> 
        Description of the Microsoft Windows registry.</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<h3>Microsoft Key Management Service MOM Pack</h3>
<p>You can use the Microsoft Windows Key Management Service MOM pack to manage the 
KMS environment, to meet the established availability requirements, and to support 
extensive reporting of KMS activations. </p>
<p>The KMS MOM Pack is shipped separately from Vista. To download the KMS MOM Pack, 
go to
<a href="http://www.microsoft.com/technet/prodtechnol/mom/mom2005/catalog.aspx">
http://www.microsoft.com/technet/prodtechnol/mom/mom2005/catalog.aspx</a></p>
<p><b>Note&nbsp;&nbsp;&nbsp;</b>This may be available in Q1 2007.</p>
<p>Documentation provided with the MOM pack discusses installation, configuration 
and how to use KMS rules on your MOM Server as well as the KMS reports on your MOM 
Data Warehouse.</p>
<h4>Known Issues with the MOM Pack </h4>
<p>On 64-bit versions of Windows Vista, the MOM 2003 Agent (which is 32 bits) cannot 
see the version number stored in the registry. This value is used to determine membership 
in the Computer Group defined by the KMS MOM Pack. Without being joined in the Computer 
Group, the KMS will not provide data to the MOM server&#39;s data warehouse. The registry 
value is created by slmgr.vbs when the KMS is activated and is stored by default 
in the 64-bit view of the registry. There are two ways to work around this issue; 
for details, see <a href="#AppendixIII">Appendix 3: Resolving MOM 2003 Installation 
Issue</a>.</p>
<h4>KMS Health Monitoring</h4>
<p>The KMS MOM Pack monitors the health of the KMS hosts by checking for error conditions 
and availability. It alerts administrators when a potential problem is observed. 
Alerts are generated for the following conditions:</p>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>KMS initialization failures</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>DNS SRV publishing failures</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>KMS host count is below a specified threshold</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>No KMS activity has occurred for designated periods</p>
    </td>
  </tr>
</table>
<div id="#KMSActivityReporting">
  <h4>KMS Activity Reporting</h4>
  <p>A sample set of SQL reports is provided for use as a basis for extensive reporting 
  on activation. These reports are as follows:</p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Activation Count Summary:</b> Shows the number of KMS activations for 
      each Windows edition and for several historical time ranges. </p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Virtual Machine Summary:</b> Breaks the cumulative number of virtual 
      machines and physical machines that are activated using KMS activations for 
      each Windows edition. </p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>KMS Activity Summary:</b> Shows daily new KMS activations for each Windows 
      edition. The Total Requests chart shows daily KMS request activity, which 
      includes both activations and renewals, for each Windows edition. </p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Licensing Status Summary: </b>Shows the number of days left to expiration 
      for computer that have connected to a KMS for each of the license states.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Machine Expiration Chart:</b> Shows the number of computers that are 
      in OOB, OOT/Exp, or non-Genuine grace, whose users could be locked out (Unlicensed) 
      in the next 30 days.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Machine Expiration Detail:</b> Lists the computers that are in OOB, 
      OOT/Exp or non-Genuine grace whose users could fall into Reduced Functionality 
      Mode (Unlicensed) in the next 7 days.</p>
      </td>
    </tr>
  </table>
</div>
<h3>Backup Requirements</h3>
<p>Back up is not required for KMS hosts. However, if you need to track the KMS 
activations, you can periodically export the Key Management Service Event log data 
under Applications and Services Logs for activation history.</p>
<h3>Group Policy Support</h3>
<p>There are no Group-Policy specific additions or changes for Volume Licensing. 
All configuration and property data is supported by WMI and/or the Windows registry, 
and can therefore, be managed with Group Policy.</p>
<h3>Disabling Windows Anytime Upgrade</h3>
<p>The Windows Anytime Upgrade (WAU) program allows a Vista Business user to purchase 
an upgrade directly from Microsoft by clicking the Windows Anytime Upgrade link 
in <b>All Programs</b> and<i>&nbsp;</i><b>Extras and Upgrades</b>. This link and the 
program are only provided in Vista Business editions because both volume-licensed 
and retail versions of this product are available (unlike Vista Enterprise, which 
is only sold as a Volume License version). </p>
<p>Allowing users to attempt to upgrade their computers is generally undesirable. 
Fortunately, there is a way for system administrators to disable access to WAU in 
Vista Business editions by adding a registry value to the reference image prior 
to deployment. When WAU is disabled, an error message is displayed if the user clicks 
the WAU link, as shown in the figure that follows. This prevents the user from obtaining 
an upgrade license using the Control Panel. Note that a determined user can still 
attempt to upgrade by going directly to the Microsoft Windows Anytime Upgrade Web 
site.</p>
<p>The following procedure helps disable access to the site.</p>
<table cellspacing="0" class="dataTable" id="EELAG" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEGLAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To disable Windows Anytime Upgrade using Volume Activation media</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">On the reference image for client computer, create 
        the WAU registry value using regedit.exe.</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p>Navigate to <b>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies</b></p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p class="lastInCell">If necessary, create subkeys and navigate to
            <b>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\WAU</b></p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>Create the following values under <b>WAU</b></p>
            <p>Value Name: <b>Disabled</b></p>
            <p>Type: DWORD</p>
            <p>Value Data: 1</p>
            <p><b>Important note: </b>This section contains information about how 
            to modify the registry. Make sure to back up the registry before you 
            modify it. Make sure that you know how to restore the registry if a 
            problem occurs. For more information about how to back up, restore, 
            and modify the registry, click the following article number to view 
            the article in the Microsoft Knowledge Base:
            <a href="http://support.microsoft.com/kb/256986/" target="_blank">256986</a> 
            Description of the Microsoft Windows registry.</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p class="lastInCell">Complete the reference image and deploy it using standard 
        techniques. The resulting media will display an error message if the user 
        clicks on the WAU link.</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<div style="
          width: 336px
        ">
  <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act08.gif" alt="Figure 4: Disabled WAU" width="336" height="110"><br>
  <p class="figureCaption"><b>Figure 4: Disabled WAU</b><br>
  <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact08_big.gif" target="_blank">
  See full-sized image</a></p>
  <div class="figureRule">
  </div>
</div>
<h3>Display Volume license Information</h3>
<p>You can display information about your Volume License computers using the slmgr.vbs 
–dli<i>&nbsp;</i>script. This provides general information about the current license, 
including the license state and remaining expiration time or grace period, and information 
for KMS clients or KMS hosts. In addition to this information, you can view more 
detailed licensing information using the slmgr.vbs –dlv,<i>&nbsp;</i>which may be useful 
for support purposes.</p>
<p>The following procedure helps display Volume License information.</p>
<table cellspacing="0" class="dataTable" id="EINAG" cellpadding="0">
  <thead>
    <tr valign="top" class="stdHeader">
      <td id="colEKNAG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To display Volume License information&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
  </thead>
  <tr valign="top" class="record">
    <td style="
          border-right: solid 1px #CCCCCC
        ">
    <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>1.</p>
        </td>
        <td>
        <p class="lastInCell">Launch the command window. (Administrator privilege 
        is not required here.)</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>2.</p>
        </td>
        <td>
        <p>Run the following script:</p>
        <p><i>cscript \windows\system32\slmgr.vbs –dli</i></p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>3.</p>
        </td>
        <td>
        <p>Information displayed includes the following:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><b>Global information (example)</b></p>
            <p>Name: Windows(TM) Vista, Enterprise edition</p>
            <p>Description: Windows Operating System - Vista, ENVIRONMENT channel</p>
            <p>Partial Product Key: RHXCM</p>
            <p>License Status: Licensed</p>
            <p>Volume activation expiration: 43162 minutes (29 days)</p>
            <p>Evaluation End Date: 8/29/2007 4:59:59 PM</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><b>For KMS clients (example)</b></p>
            <p>Key Management Service client information</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;Client Machine ID (CMID): 45d450a8-2bef-4f04-9271-6104516a1b60</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;DNS auto-discovery: KMS name not available from DNS</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;KMS machine extended PID: 11111-00140-008-805425-03-1033-5384.0000-1752006</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;Activation interval: 120 minute(s)</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;Renewal interval: 10080 minute(s)</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><b>For KMS machines (example)</b></p>
            <p>Key Management Service is enabled on this machine</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;Current count: 7</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;Listening on Port: 1688</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;DNS Publishing: Enabled</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;KMS priority: Normal</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>4.</p>
        </td>
        <td>
        <p>Run the following script to display more licensing support information 
        that may be useful for support purposes:</p>
        <p><i>cscript \windows\system32\slmgr.vbs –dlv</i><br>
        For example:</p>
        <p>Software licensing service version: 6.0.5384.4</p>
        <p>ActivationID: 14478aca-ea15-4958-ac34-359281101c99</p>
        <p>ApplicationID: 55c92734-d682-4d71-983e-d6ec3f16059f</p>
        <p>Extended PID: 11111-00140-009-000002-03-1033-5384.0000-1942006</p>
        <p>Installation ID: 000963843315259493598506854253663081409973656140419231</p>
        </td>
      </tr>
      <tr valign="top">
        <td class="listNumber" nowrap align="right">
        <p>5.</p>
        </td>
        <td>
        <p>Run the following script to display more licensing support information 
        for all installed licenses:</p>
        <p><i>cscript \windows\system32\slmgr.vbs -dlv all</i></p>
        <p>Note&nbsp;&nbsp;&nbsp;Only one license can be in use, namely the one that has a partial 
        product key.&nbsp;&nbsp;&nbsp;</p>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<div class="dataTableBottomMargin">
</div>
<h3>Software Asset Management</h3>
<p>Software Asset Management (SAM) is about knowledge of software, its life-cycle, 
and its use within an organization. Knowledge of exactly what software the business 
owns, owning only the software each business needs, and being able to actively manage 
new software purchases help organizations in better management of their software 
as asset. Organizations fully in control of their software assets reap the benefits 
of higher productivity, reduced downtime, increased support from software vendors, 
and increased ability to stay compliant to the software licensing terms. With the 
introduction of Software Protection Platform (SPP) in Windows Vista and Windows 
Server “Longhorn”, Microsoft is introducing a licensed store, set of Public APIs 
(see MSDN for details), and WMI properties (see “Volume Activation&nbsp;2.0 Technical 
Attributes.xls” in
<a href="http://go.microsoft.com/fwlink/?LinkId=76703" target="_blank">http://go.microsoft.com/fwlink/?LinkId=76703</a>) 
as part of SPP. This enables remote querying, tracking, and reporting of individual 
installations and the corresponding license information.&nbsp; </p>
<div id="Troubleshooting">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="EVPAG"></a>
  <h2>Troubleshooting</h2>
  <p>This section provides guidance on troubleshooting some commonly faced issues 
  of Volume Activation&nbsp;2.0.</p>
  <h3>MAK Activation Troubleshooting Steps </h3>
  <p>The following table presents issues related to MAK activation.</p>
  <table cellspacing="0" class="dataTable" id="E3PAG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colE5PAG" width="21%">Issue</td>
        <td id="colECQAG" width="79%" style="
              border-right: solid 1px #CCCCCC
            ">Resolution</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">How can I tell if my computer is activated?</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>1.</p>
          </td>
          <td>
          <p class="lastInCell">Look for “Windows is activated&quot; in the Welcome Center 
          or in System under Control Panel.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>2.</p>
          </td>
          <td>
          <p class="lastInCell">Run the <b>slmgr.vbs –dli</b> script.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>3.</p>
          </td>
          <td>
          <p class="lastInCell">“License Status:” shows whether you are activated 
          (“Licensed”), in OOB grace, or OOT grace. If it displays “Unlicensed,” 
          you will not be able to log on again until your computer is activated.</p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">Computer does not activate over the Internet.</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p>Ensure that the computer can access Internet sites, for example, http://microsoft.com.</p>
      <p>You may need to set a proxy. Do this from your browser or Control Panel.</p>
      <p>If the computer cannot connect to the Internet, use telephone activation.</p>
      </td>
    </tr>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">Internet and telephone activation fail.</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p>Contact the Microsoft Activation Call Center at 1-888-352-7140 (US customers 
      only). For international customers, contact your local support center. For 
      phone numbers of activation centers worldwide, go to the following URL:</p>
      <p>
      <a href="http://www.microsoft.com/licensing/resources/vol/numbers.mspx" target="_blank">
      http://www.microsoft.com/licensing/resources/vol/numbers.mspx</a></p>
      <p>Customers will need to provide their Volume License agreement information 
      and proof of purchase when they call.</p>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">slmgr.vbs –ato returns an error code.</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p>If slmgr.vbs returns a hexadecimal error code, you can determine the corresponding 
      error message by running the following script:</p>
      <p><i>Slui.exe 0x2a 0x&lt;error code&gt;</i></p>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
  <p><b>Table 7: MAK Troubleshooting Steps</b></p>
  <h3>KMS Activation Troubleshooting Steps</h3>
  <p>The following table presents issues related to KMS activation.</p>
  <table cellspacing="0" class="dataTable" id="EWRAG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colEYRAG" width="35%">Issue</td>
        <td id="colE3RAG" width="65%" style="
              border-right: solid 1px #CCCCCC
            ">Resolution</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">How can I tell if my computer is activated?</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>1.</p>
          </td>
          <td>
          <p class="lastInCell">Look for “Windows is activated&quot; in the Welcome Center 
          or in System under Control Panel.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>2.</p>
          </td>
          <td>
          <p>Run the slmgr.vbs –dli script.</p>
          <p>“License Status:” shows whether you are activated (“Licensed”), in 
          OOB grace, or OOT grace. If it displays “Unlicensed,” you will not be 
          able to log on again until your computer is activated.</p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">The computer does not activate.</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p>Verify that the KMS host has been contacted by the minimum number of clients 
      required for activation. Until the KMS host has a count of 25, clients will 
      not be allowed to activate. If a client fails to activate at all within 30 
      days, it will fall into Reduced Functionality Mode and will be prevented from 
      logging on. Run slmgr.vbs –dli on the KMS host to determine its “current count.”</p>
      <p>On the KMS client, look in the Windows Application event log for event 
      #12289 (KMS response). If you find one at the expected time, report this to 
      Microsoft, because the computer should have activated. </p>
      <p>Check client event #12288 and consider the following:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">Is the result code 0? Anything else is an error.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">Is the KMS host name shown in the event correct?</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">Is the KMS port correct? </p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">Is the KMS host accessible? </p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">If you have a third-party firewall, does your outbound 
          port need to be configured?</p>
          </td>
        </tr>
      </table>
      <p>Check KMS event #12290</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">Did the KMS host log an event for the client computer? 
          Check to see if the name of your computer is listed? If so, the response 
          was sent to the client, but got lost in the network or at the client. 
          Verify that the client and KMS host can communicate. Ensure that your 
          routers do not block TCP traffic to TCP port 1688 (default). Check the 
          firewall on the client.</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p class="lastInCell">If no event was logged for the client, its request 
          did not reach the KMS or the KMS was unable to process it. </p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">slmgr.vbs –ato returns an error code.</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p>If slmgr.vbs returns a hexadecimal error code, or event 12288 contains 
      a result code other than 0, you can determine the corresponding error message 
      by running the following command:</p>
      <p><i>Slui.exe 0x2a 0x&lt;error code&gt;</i></p>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
  <p><b>Table 8: KMS Troubleshooting Steps</b></p>
  <h3>KMS Activation of OEM Computers </h3>
  <p>For KMS activation to work, computers obtained through the Original Equipment 
  Manufacturer (OEM) channels which have an ACPI_SLIC table in the system BIOS are 
  required to have a valid Windows marker in the same ACPI_SLIC table. The appearance 
  of the Windows marker is important for Volume License customers who are planning 
  to use Windows Vista Volume License media to re-image or upgrade OEM through the 
  re-imaging rights provided in their Volume License agreement. Computers that have 
  an ACPI_SLIC table without a valid Windows marker will result in the following 
  error(s) on these systems and they will be unable to activate using a KMS:</p>
  <p><b>Error Code: </b>Invalid Volume License Key</p>
  <p>In order to activate, you need to change your product key to a valid Multiple 
  Activation Key (MAK) or Retail key.</p>
  <p>You must have a qualifying operating system license AND a Volume License Windows 
  Vista upgrade license, or a full license for Windows Vista through an OEM or from 
  a retail source.</p>
  <p><b>ANY OTHER INSTALLATION OF THIS SOFTWARE IS IN VIOLATION OF YOUR AGREEMENT 
  AND APPLICABLE COPYRIGHT LAW.</b></p>
  <p><b>Error Code: </b>0xC004F059</p>
  <p><b>Description:</b> The Software Licensing Service reported that a license 
  in the computer BIOS is invalid.</p>
  <p><b>Options to resolve the above errors are:</b></p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p>Use a Multiple Activation Key (MAK) to activate the computer.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p>Contact your OEM for a replacement motherboard that contains a valid Windows 
      marker in the ACPI_SLIC table.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p>Purchase new computers with Microsoft Windows preinstalled to ensure that 
      a valid BIOS is installed in the system.</p>
      <p>Volume licensed versions of Windows require upgrading from a qualifying 
      operating system as per the terms of your agreement.</p>
      </td>
    </tr>
  </table>
  <div id="#MappingErrorCodes">
    <h3>Mapping Error Codes to Text Messages </h3>
    <p>You can use slui.exe to map most activation-related error codes to corresponding 
    text messages. Run the following command on your Windows Vista computer:</p>
    <p><i>Slui.exe 0x2a 0x&lt;error code&gt;</i></p>
    <p>This will display a dialog box with the error information.</p>
    <p>For example, if event 12293 contains an error code 0x8007267C, you can determine 
    the corresponding error message by running the following command: </p>
    <p><i>Slui.exe 0x2a 0x8007267C</i></p>
    <p>The message will display “No DNS servers configured for local system.”</p>
  </div>
  <h3>Reviewing Activation Events</h3>
  <p>The Windows event log provides detailed logging of activation events. The event 
  provider name for all activation events is Microsoft-Windows-Security-Licensing-SLC. 
  All events are found in the Windows Application event log except for the KMS activity 
  event 12290, which is in its own event log in Applications and Services Logs\Key 
  Management Service. For a detailed list of events, see “Volume Activation&nbsp;2.0 
  Technical Attributes.xls.”</p>
  <h3>WMI Providers </h3>
  <p>The built-in script, <i>c:\windows\system32\slmgr.vbs</i>, uses Windows Management 
  Infrastructure (WMI) to access available WMI properties. Use the -dli option to 
  display activation-related information. For list of WMI providers, see “Volume 
  Activation&nbsp;2.0 Technical Attributes.xls.”</p>
  <div id="#ResolvingRFM">
    <h3>Resolving Reduced Functionality Mode</h3>
    <p>As with Windows&nbsp;XP, after initial installation and the conclusion of the 
    grace period, product activation will be required. Failure to activate will 
    result in the copy of Windows Vista being placed in Reduced Functionality Mode 
    (RFM). There is no start menu, no desktop icons, and the desktop background 
    is changed to black.&nbsp;&nbsp;After one hour, the system will log the user out without 
    warning. It will not shut down the computer, and the user can log back in. This 
    is different from the Windows&nbsp;XP RFM experience, which limited screen resolution, 
    colors, sounds and other features.</p>
    <p>It should be noted that in all versions of product activation, the software 
    can be used during the Initial Grace period without entry of a product key. 
    Once a copy of Windows Vista has moved into RFM, the user will be presented 
    the four options listed in the following figure, at their next logon attempt:</p>
    <div style="
          width: 336px
        ">
      <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act09.gif" alt="Figure 5: Windows Activation Dialog box" width="336" height="273"><br>
      <p class="figureCaption"><b>Figure 5: Windows Activation Dialog box</b><br>
      <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact09_big.gif" target="_blank">
      See full-sized image</a></p>
      <div class="figureRule">
      </div>
    </div>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>Users who already have a product key but have not activated their computer 
        should click <b>Activate Windows online now</b>.</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>By clicking <b>Access your computer with reduced functionality</b>, the 
        default Web browser is started and the user is presented with an option 
        to purchase a new product key. The Web browser will fully function and Internet 
        connectivity will not be blocked. </p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>If the user has acquired another product key (either through eligibility 
        for a MAK or by purchasing a key online), they can use the new key to activate 
        by clicking <b>Retype your product key</b>.</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>If no Internet connection is detected, the user can click <b>Show me 
        other ways to activate</b> to use telephone activation. This option will 
        not be active if an Internet connection is present on the system.</p>
        </td>
      </tr>
    </table>
    <p>A copy of Windows Vista can go into RFM under the following two scenarios:</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p><b>Scenario 1:</b> If any of the following events occurs for the given 
        license type:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><b>For MAK activated and KMS host computers:</b> Failure to activate 
            within the grace period (that is, 30 days after installation) or failure 
            to renew activation within 30 days of a major hardware replacement</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p><b>For KMS activated computers: </b>Failure to activate with a KMS 
            within 30 days of<b>&nbsp;</b>installation,<b>&nbsp;</b>failure to renew activation 
            with KMS within 210 (180 days plus 30 days grace period) days of previous 
            renewal, or failure to renew activation with KMS within 30 days of hard 
            drive replacement</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p><b>Scenario 2:</b> A copy of Windows Vista may be required to reactivate 
        for the following reasons, and failure to successfully reactivate during 
        the 30-day grace period will cause the copy of Windows Vista to go into 
        RFM:</p>
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>The activation process has been determined to have been tampered 
            with or worked around, or other tampering of license files is detected.</p>
            </td>
          </tr>
          <tr>
            <td class="listBullet" valign="top">•</td>
            <td class="listItem">
            <p>A leaked, stolen, or prohibited product key is detected and blocked 
            by Microsoft Product Activation servers. Product keys may be prohibited 
            for any of the following reasons: The product key is abused, stolen, 
            or pirated; the product key is seized as a result of anti-piracy enforcement 
            efforts; the key is beta or test key and has been disabled; there was 
            a manufacturing error in the key; or the key has been returned. When 
            a copy of Windows enters RFM as a result of this scenario, the user 
            is notified of this status via a message pop-up. </p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
    </table>
    <p>In the event that a system is placed into RFM, the following remedies are 
    available:</p>
    <table cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>If a client has exceeded the grace period, the <b>Windows Activation</b> 
        dialog box appears, as shown in Figure 5. Follow the prescribed activation 
        process and the options already described. These include entering a new 
        product key, obtaining a new product key, or re-entering the original product 
        key. </p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>Reconnect a KMS-activated client to the network that houses the KMS host. 
        The client automatically contacts the KMS host to renew its activation.</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>If a KMS client cannot be returned to its home network but is able to 
        access the Internet, it can be activated using a MAK. In the <b>RFM</b> 
        dialog box, click <b>Change Product Key</b> to type the MAK. If the client 
        is unable to connect to the Internet, you can also use telephone activation. 
        Changing to a MAK does not provide an additional grace period. The client 
        remains in RFM until the computer is activated—either via the Internet or 
        by telephone. You can also supply the MAK through scripting by using the 
        slmgr.vbs script with the <b><i>-</i></b><i>ipk</i> option. (See Configure 
        a client to use MAK Activation using a script for details.)<br>
        <b>Note</b>&nbsp;&nbsp;&nbsp;Alternatively, to automate this process for end users (if 
        the standard user activation option is enabled), the administrator can create 
        a script called by a custom web page. See <a href="#AppendixII">Appendix 
        2: Standard User Activation Webpage</a>.</p>
        </td>
      </tr>
      <tr>
        <td class="listBullet" valign="top">•</td>
        <td class="listItem">
        <p>A client can be returned to its initial activation state for the current 
        license by using the slmgr.vbs script with the <b><i>-</i></b><i>rearm</i> 
        option. This option resets the computer’s activation timer and reinitializes 
        some activation parameters, including a KMS client’s unique machine ID (also 
        known as <i>client machine ID,</i> or CMID). The number of times this can 
        be repeated is limited and depends on how many times <i>sysprep /generalize</i> 
        is run to create the distribution media. The maximum number of rearms possible 
        is three. Note that rearm requires administrator privilege. However, an 
        Administrator can enable use by ordinary users by creating the following 
        registry entry: <b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\</b><br>
        <b>CurrentVersion\SL\UserOperations</b> (REG_DWORD) to <i>1.</i></p>
        </td>
      </tr>
    </table>
    <p><b>Important note:</b> This section contains information about how to modify 
    the registry. Make sure to back up the registry before you modify it. Make sure 
    that you know how to restore the registry if a problem occurs. For more information 
    about how to back up, restore, and modify the registry, click the following 
    article number to view the article in the Microsoft Base:
    <a href="http://support.microsoft.com/kb/256986/" target="_blank">256986</a> 
    (http://support.microsoft.com/kb/256986/) Description of the Microsoft Windows 
    registry.</p>
  </div>
</div>
<div id="#RecoveryfromnonGenuine">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="EXZAG"></a>
  <h2>Appendix 1: Resolving Non-Genuine Issues on Computers</h2>
  <p>If either a Volume Activation 2.0 customer or Microsoft detects that a KMS 
  key or a MAK has been misused, after discussions between the customer and Microsoft, 
  the product key can be marked as invalid for activation and as non-Genuine. When 
  a volume edition client visits Microsoft Web sites requiring Genuine Validation, 
  it will have to download and run either an ActiveX control or a small .exe application 
  to access the download. If the computer is configured with an invalid key or tampered 
  files are detected, the computer will fail Genuine Validation. The user will be 
  notified by a watermark on the desktop and periodic notifications to validate 
  the Genuine status of the system by visiting a Microsoft Web site. In addition, 
  the computer may be placed in a 30-day non-Genuine grace period during which it 
  needs to be configured with a new product key or reinstalled if tampered files 
  are detected. For MAK configured systems, a new MAK must be installed and activated 
  on the computer. For computers activated with an invalid KMS key, the KMS host 
  must first be activated with a new KMS key. KMS clients will then reactivate themselves 
  after contacting the reconfigured KMS host. In both scenarios, computers that 
  have downloaded the Genuine Advantage ActiveX control must also visit the Genuine 
  Advantage Web site to change their Genuine status from non-Genuine to Genuine 
  after being activated with a new product key.</p>
  <p>If a new product key has not been installed and activated, and the status has 
  not changed during the 30-day non-Genuine grace period, the computer will start 
  in non-Genuine RFM. In RFM, a user will only have options to access Web sites 
  using their browser for an hour, before being logged off by the system.</p>
  <p>Two different approaches exist to correct the Genuine status of a computer 
  that is running a volume licensed version of Windows Vista: the manual approach 
  using slmgr.vbs and the Product Activation Wizard. This guide outlines both these 
  approaches.</p>
  <p><b>Note</b>&nbsp;&nbsp;&nbsp;The script method (available post Windows Vista RTM) will help 
  administrators perform network-based recovery of non-Genuine computers.</p>
  <h3>Recovering Non-Genuine Windows Vista Computers</h3>
  <p>This process is comprised of the following two steps:</p>
  <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
    <tr valign="top">
      <td class="listNumber" nowrap align="right">
      <p>1.</p>
      </td>
      <td>
      <p>Determine the reason for Genuine Validation failure.</p>
      </td>
    </tr>
    <tr valign="top">
      <td class="listNumber" nowrap align="right">
      <p>2.</p>
      </td>
      <td>
      <p>Follow appropriate recovery steps for KMS or MAK-configured computers.</p>
      </td>
    </tr>
  </table>
  <p>On a non-Genuine computer, examine the Application Event Log, for Event ID: 
  8209</p>
  <p>Log Name: Application</p>
  <p>Source: Microsoft-Windows-Security-Licensing-SLC</p>
  <p>Event ID: 8209</p>
  <p>The description field will provide an error code explaining the non-Genuine 
  status of a computer.</p>
  <table cellspacing="0" class="dataTable" id="EP1AG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colER1AG" width="40%">Error Code</td>
        <td id="colEV1AG" width="60%" style="
              border-right: solid 1px #CCCCCC
            ">Reason</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell"><b>0x8004C40B</b></p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">Tampered files</p>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell"><b>0x8004C465</b></p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">Invalid or Blocked Product Key</p>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
  <p><b>Table 9: RFM Reason Error Codes</b></p>
  <h3>Recovery from Non-Genuine State Due to Tampered Files</h3>
  <p>It is recommended to re-install the operating system on computers that have 
  non-Genuine status due to tampered files, after ensuring that all required user 
  data has been saved to another location. After installing the operating system, 
  the computer will have to be activated. The user can then validate Genuine status 
  at: <a href="http://go.microsoft.com/fwlink/?LinkId=64187" target="_blank">http://go.microsoft.com/fwlink/?LinkId=64187</a>.</p>
  <div id="#RecoveryKMSMachinesNonGenuine">
    <h3>Recovery from Non-Genuine State for Invalid or Blocked Product Key</h3>
    <p>If a KMS host or KMS client is marked non-Genuine due to a compromised product 
    key, you need to replace the KMS key on all KMS hosts configured with the compromised 
    product key. Then, you need to activate all KMS clients against the re-keyed 
    KMS hosts. </p>
    <table cellspacing="0" class="dataTable" id="EX2AG" cellpadding="0">
      <thead>
        <tr valign="top" class="stdHeader">
          <td id="colEZ2AG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To recover KMS hosts in non-Genuine Grace</td>
        </tr>
      </thead>
      <tr valign="top" class="record">
        <td style="
          border-right: solid 1px #CCCCCC
        ">
        <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>1.</p>
            </td>
            <td>
            <p class="lastInCell">Install the new KMS key on each KMS host configured 
            with the invalid KMS key. Run <i>Slmgr.vbs [computername] [username] 
            [password] -ipk &lt;new_KMS_Key&gt; </i>in an elevated command prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>2.</p>
            </td>
            <td>
            <p class="lastInCell">Activate the new KMS key. Run<i> Slmgr.vbs [computername] 
            [username] [password] –ato</i> in an elevated command prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>3.</p>
            </td>
            <td>
            <p class="lastInCell">Verify that the new product key is installed by 
            running: <i>Slmgr.vbs [computername] [username] [password] –dli</i> 
            from a command prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>4.</p>
            </td>
            <td>
            <p class="lastInCell">If the KMS host is installed with the Genuine 
            Advantage ActiveX control, visit the Genuine Advantage Web site (<a href="http://go.microsoft.com/fwlink/?LinkId=64187" target="_blank">http://go.microsoft.com/fwlink/?LinkId=64187</a>) 
            to validate the status.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>5.</p>
            </td>
            <td>
            <p class="lastInCell">Restart “Software Licensing” service by clicking
            <b>Start, Settings, Control Panel</b><i>,&nbsp;</i><b>Administrative Tools</b><i>,&nbsp;</i>and<i>&nbsp;</i><b>Services</b><i>.
            </i>Select <b>Software Licensing Service</b> and click [Restart].</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>6.</p>
            </td>
            <td>
            <p class="lastInCell">Restart the KMS host to remove the non-Genuine 
            watermark from the desktop.</p>
            </td>
          </tr>
        </table>
        <p><b>Note</b>&nbsp;&nbsp;&nbsp;It is recommended not to download software from the Internet 
        directly on a computer providing KMS services.</p>
        </td>
      </tr>
    </table>
    <div class="dataTableBottomMargin">
    </div>
    <p>Next, perform the following steps to recover KMS clients:</p>
    <table cellspacing="0" class="dataTable" id="EE5AG" cellpadding="0">
      <thead>
        <tr valign="top" class="stdHeader">
          <td id="colEG5AG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To recover KMS clients in non-Genuine Grace</td>
        </tr>
      </thead>
      <tr valign="top" class="record">
        <td style="
          border-right: solid 1px #CCCCCC
        ">
        <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>1.</p>
            </td>
            <td>
            <p class="lastInCell">Reconfigure all KMS hosts as outlined in
            <a href="#RecoveryKMSMachinesNonGenuine">To recover KMS Hosts in non-Genuine 
            Grace</a>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>2.</p>
            </td>
            <td>
            <p class="lastInCell">Administrators can wait for all KMS clients to 
            auto-renew their activations within 7 days (default), or force activation 
            renewal by using the slmgr.vbs script: <i>slmgr.vbs [computername] [username] 
            [password] –ato</i>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>3.</p>
            </td>
            <td>
            <p class="lastInCell">Verify that clients activate themselves after 
            contacting the reconfigured KMS host and by running <i>slmgr.vbs [computername] 
            [username] [password] –dli</i> from a Command Prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>4.</p>
            </td>
            <td>
            <p class="lastInCell">If the KMS client is installed with the Genuine 
            Advantage ActiveX control, visit the Genuine Advantage Web site (<a href="http://go.microsoft.com/fwlink/?LinkId=64187" target="_blank">http://go.microsoft.com/fwlink/?LinkId=64187</a>) 
            to validate the status.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>5.</p>
            </td>
            <td>
            <p class="lastInCell">Restart the client to remove the non-Genuine desktop 
            watermark.</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
    </table>
    <div class="dataTableBottomMargin">
    </div>
    <table cellspacing="0" class="dataTable" id="EK6AG" cellpadding="0">
      <thead>
        <tr valign="top" class="stdHeader">
          <td id="colEM6AG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To recover MAK activated computers in non-Genuine Grace</td>
        </tr>
      </thead>
      <tr valign="top" class="record">
        <td style="
          border-right: solid 1px #CCCCCC
        ">
        <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>1.</p>
            </td>
            <td>
            <p class="lastInCell">Install a new MAK on each computer configured 
            with the invalid MAK. Run <i>Slmgr.vbs [computername] [username] [password] 
            -ipk &lt;new_MAK_Key&gt; </i>in an elevated command prompt. </p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>2.</p>
            </td>
            <td>
            <p class="lastInCell">Activate the new MAK. Run <i>Slmgr.vbs [computername] 
            [username] [password] –ato</i> in an elevated command prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>3.</p>
            </td>
            <td>
            <p class="lastInCell">Verify that the new product key is installed by 
            running:<br>
            <i>Slmgr.vbs [computername] [username] [password] –dli</i> from the 
            command prompt.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>4.</p>
            </td>
            <td>
            <p class="lastInCell">If the MAK computer is installed with the Genuine 
            Advantage ActiveX control, visit the Genuine Advantage Web site (<a href="http://go.microsoft.com/fwlink/?LinkId=64187" target="_blank">http://go.microsoft.com/fwlink/?LinkId=64187</a>) 
            to validate the status.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>5.</p>
            </td>
            <td>
            <p class="lastInCell">Restart the system to remove the non-Genuine watermark 
            from the desktop.</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
    </table>
    <div class="dataTableBottomMargin">
    </div>
    <table cellspacing="0" class="dataTable" id="ERABG" cellpadding="0">
      <thead>
        <tr valign="top" class="stdHeader">
          <td id="colETABG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To recover KMS hosts or clients or MAK activated computers in non-Genuine 
          RFM</td>
        </tr>
      </thead>
      <tr valign="top" class="record">
        <td style="
          border-right: solid 1px #CCCCCC
        ">
        <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>1.</p>
            </td>
            <td>
            <p class="lastInCell">For MAK configured computers, use the remote operations 
            functionality of slmgr.vbs as detailed in the previous procedure:
            <a href="#RecoveryKMSMachinesNonGenuine">To recover MAK activated computers 
            in non-Genuine Grace</a>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>2.</p>
            </td>
            <td>
            <p class="lastInCell">For KMS hosts, use the remote operations functionality 
            of slmgr.vbs as detailed in the previous procedure:
            <a href="#RecoveryKMSMachinesNonGenuine">To recover KMS hosts in non-Genuine 
            Grace</a>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>3.</p>
            </td>
            <td>
            <p class="lastInCell">For KMS clients, first ensure that the KMS host 
            has been recovered as detailed in the previous procedure:
            <a href="#RecoveryKMSMachinesNonGenuine">To recover KMS hosts in non-Genuine 
            Grace</a>. Then use the remote operations functionality of slmgr.vbs 
            as detailed in the above section:<b>&nbsp;</b><a href="#RecoveryKMSMachinesNonGenuine">To 
            recover KMS clients in non-Genuine Grace</a>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>4.</p>
            </td>
            <td>
            <p class="lastInCell">For computers in non-Genuine RFM, after completing 
            step 1, 2 or 3, click the link in the non-Genuine RFM window to visit 
            the Genuine Advantage Web site (<a href="http://go.microsoft.com/fwlink/?LinkId=64187" target="_blank">http://go.microsoft.com/fwlink/?LinkId=64187</a>) 
            to validate the status.</p>
            </td>
          </tr>
          <tr valign="top">
            <td class="listNumber" nowrap align="right">
            <p>5.</p>
            </td>
            <td>
            <p class="lastInCell">Restart the computer to remove the desktop watermark.</p>
            </td>
          </tr>
        </table>
        </td>
      </tr>
    </table>
    <div class="dataTableBottomMargin">
    </div>
  </div>
</div>
<div id="#AppendixII">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="E3BBG"></a>
  <h2>Appendix 2: Recovery from RFM using Standard User Product Activation Web Page</h2>
  <p>By default, product activation in Windows Vista requires local administrator 
  privileges. However, system administrators can configure computers for product 
  activation by standard users by creating and setting the following registry value:</p>
  <p><b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\</b><br>
  <b>CurrentVersion\SL\UserOperations (REG_DWORD)</b> to 1.</p>
  <p><b>Important note: </b>This section contains information about how to modify 
  the registry. Make sure to back up the registry before you modify it. Make sure 
  that you know how to restore the registry if a problem occurs. For more information 
  about how to back up, restore, and modify the registry, click the following article 
  number to view the article in the Microsoft Description of the Microsoft Base:
  <a href="http://support.microsoft.com/kb/256986/" target="_blank">256986</a> Description 
  of Microsoft Windows registry.</p>
  <p>Even after setting this registry value, the Product Activation Wizard will 
  still be displayed with the User Account Control ‘shield’ icon. The standard user 
  is left with two options for installing product keys and activating computers:</p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Command Line:</b> Use the slmgr.vbs script to install product keys, 
      and activate the computer. For the specific syntax, see the &quot;<a href="#DeploymentGuidance">Deployment 
      Guidance</a>&quot; section earlier in this guide.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p><b>Standard User Product Activation Web page (ProductActivation.htm):</b> 
      In the file StandardUserProductActivation.zip, a sample Web page containing 
      a VBScript is provided for administrators for implementing standard user activation. 
      This Web page provides the standard user with several options:</p>
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><b>Product Keys:</b> Enter in a new product key or install an optional 
          administrator configured product key</p>
          </td>
        </tr>
        <tr>
          <td class="listBullet" valign="top">•</td>
          <td class="listItem">
          <p><b>Activation methods:</b> Activate using the Internet, activate over 
          telephone, or reset the grace period for activation. The ‘reset’ option 
          can be run only three times from the first time the operating system is 
          installed. A reset is also performed when running ‘sysprep /generalize’.</p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
  <p>The StandardUserProductActivation.zip file can be downloaded from the Windows 
  Vista Volume Activation&nbsp;2.0 Download Center at
  <a href="https://mail.microsoft.com/OWA/redir.aspx?URL=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d75674" target="_blank">
  http://go.microsoft.com/fwlink/?LinkID=75674</a></p>
  <div style="
          width: 336px
        ">
    <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act10.gif" alt="Figure 6: Standard User Product Activation Web page" width="336" height="260"><br>
    <p class="figureCaption"><b>Figure 6: Standard User Product Activation Web page</b><br>
    <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact10_big.gif" target="_blank">
    See full-sized image</a></p>
    <div class="figureRule">
    </div>
  </div>
  <p>System administrators can use this Web page to enable easier recovery for standard 
  users whose computers are in RFM. When a user’s computer is in RFM, they are provided 
  the four choices shown in the following figure (upon logon):</p>
  <div style="
          width: 336px
        ">
    <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act11.gif" alt="Figure 7: Reduced Functionality Mode screen" width="336" height="226"><br>
    <p class="figureCaption"><b>Figure 7: Reduced Functionality Mode screen</b><br>
    <a href="http://www.microsoft.com/library/media/1033/technet/images/windowsvista/plan/volact11_big.gif" target="_blank">
    See full-sized image</a></p>
    <div class="figureRule">
    </div>
  </div>
  <p>In this screen, the only option available to standard users is to choose ‘Access 
  your computer with reduced functionality’, which will start the default Web browser 
  on the system. After this is started, the standard user will need to access the 
  Standard User Activation Web page, which would be in their Favorites (if previously 
  installed by an administrator) and configure a new product key to return to full 
  functionality mode. The user will have to allow ActiveX scripts to run so that 
  the VBScript can use existing WMI methods to install a product key and activate 
  the computer. Note this Web page requires the VBScript engine to work properly.</p>
  <table cellspacing="0" class="dataTable" id="EIEBG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colEKEBG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To deploy Standard User Product Activation Web page</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>1.</p>
          </td>
          <td>
          <p class="lastInCell">On the reference system, install the Web page (productactivation.htm 
          and windows-vista.png into a folder accessible by standard users, such 
          as %systemroot%\system32\SLUI). It is recommended to customize the Web 
          page for your organization to include support specific information such 
          as telephone numbers and contact information. </p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>2.</p>
          </td>
          <td>
          <p class="lastInCell">Optionally, configure an administrator specified 
          product key (5x5) in a file named pid.txt. The Web page (by default) is 
          configured to look for this file in the %systemroot%\system32\SLUI folder.
          </p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>3.</p>
          </td>
          <td>
          <p>This Web page can then be deployed as an Internet Explorer Favorite 
          to users by a number of methods:</p>
          <table cellspacing="0" cellpadding="0" border="0">
            <tr>
              <td class="listBullet" valign="top">•</td>
              <td class="listItem">
              <p class="lastInCell">Use the Internet Explorer Administration Kit 
              (IEAK). </p>
              </td>
            </tr>
            <tr>
              <td class="listBullet" valign="top">•</td>
              <td class="listItem">
              <p class="lastInCell">Use Group Policy in Active Directory environments.</p>
              </td>
            </tr>
          </table>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>4.</p>
          </td>
          <td>
          <p class="lastInCell">Configure the FavoritesList option in the component 
          &quot;Microsoft-Windows-IE-InternetExplorer&quot; in an unattend.xml setup file.</p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
  <table cellspacing="0" class="dataTable" id="EBFBG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colEDFBG" width="100%" style="
              border-right: solid 1px #CCCCCC
            ">To test the Standard User Product Activation Web page</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <table cellpadding="0" cellspacing="0" border="0" class="numberedList">
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>1.</p>
          </td>
          <td>
          <p class="lastInCell">On a computer that is not activated and is configured 
          for Standard User activation, force the system to go into RFM mode, by 
          advancing the clock ahead by 31 days and restarting the computer.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>2.</p>
          </td>
          <td>
          <p class="lastInCell">Log on as a Standard User on the computer. Verify 
          if you see the RFM screen (Figure 7) and can choose <b>Access my computer 
          with reduced functionality</b>.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>3.</p>
          </td>
          <td>
          <p class="lastInCell">Verify that Internet Explorer starts, and that the 
          Standard User Product Activation Web page can be loaded from the Favorites 
          menu.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>4.</p>
          </td>
          <td>
          <p class="lastInCell">Choose ‘Yes’ to any ActiveX prompts to allow the 
          VBScript to run successfully.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>5.</p>
          </td>
          <td>
          <p class="lastInCell">Choose to install a new product key or the administrator 
          configured key (if applicable), and choose the appropriate activation 
          method.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>6.</p>
          </td>
          <td>
          <p class="lastInCell">Follow the steps in the Web page for manual phone 
          activation (if applicable).</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>7.</p>
          </td>
          <td>
          <p class="lastInCell">Verify the process completed successfully. Close 
          the RFM wizard and restart the system.</p>
          </td>
        </tr>
        <tr valign="top">
          <td class="listNumber" nowrap align="right">
          <p>8.</p>
          </td>
          <td>
          <p class="lastInCell">Verify that logging on as a standard user or local 
          administrator displays the desktop. Verify that the computer has been 
          activated correctly by running ‘slmgr –dli’. </p>
          </td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
</div>
<div id="#AppendixIII">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="EAGBG"></a>
  <h2>Appendix 3: Resolving MOM 2003 Installation Issue</h2>
  <p>On 64-bit versions of Windows Vista, the MOM 2003 Agent (which is 32 bits) 
  cannot see the version number stored in the registry. This value is used to determine 
  membership in the Computer Group defined by the KMS MOM Pack. Without being joined 
  in the Computer Group, the KMS will not provide data to the MOM server&#39;s data 
  warehouse. The registry value is created by slmgr.vbs when the KMS is activated, 
  and is stored by default in the 64-bit view of the registry. </p>
  <p>There are two ways to workaround this installation issue:</p>
  <table cellspacing="0" cellpadding="0" border="0">
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p>This problem can be mitigated by creating a custom Computer Group on the 
      MOM server that explicitly adds all KMS hosts for collection. This can be 
      keyed off of <i>Machine Name</i> or any other queryable property.</p>
      </td>
    </tr>
    <tr>
      <td class="listBullet" valign="top">•</td>
      <td class="listItem">
      <p>From an elevated command prompt, type REGEDIT.EXE. This will open the registry 
      editor in an Administrative user context. In Regedit, copy the value of</p>
      <p><b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsNT\</b><br>
      <b>CurrentVersion\SL\KeyManagementServiceVersion </b></p>
      <p>into</p>
      <p><b>HKLM\Software\wow6432node\Microsoft\WindowsNT\</b><br>
      <b>CurrentVersion\SL\KeyManagementServiceVersion</b></p>
      </td>
    </tr>
  </table>
  <p>Regardless of the workaround chosen, it is critical that all KMS hosts running 
  the 64-bit version of the operating system have the same workaround applied.</p>
  <p><b>Important note: </b>This section contains information about how to modify 
  the registry. Make sure to back up the registry before you modify it. Make sure 
  that you know how to restore the registry if a problem occurs. For more information 
  about how to back up, restore, and modify the registry, click the following article 
  number to view the article in the Microsoft Base:
  <a href="http://support.microsoft.com/kb/256986/" target="_blank">256986</a> Description 
  of the Microsoft Windows registry.</p>
</div>
<div id="#AppenixIV">
  <div style="margin-top: 3px; margin-bottom: 10px">
    <a href="#top">
    <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
    of page</a></div>
  <a name="EFHBG"></a>
  <h2>Appendix 4: Guidance Worksheet Job-Aid</h2>
  <p>Use this Sample Guidance Worksheet to map your computers to activation solution.
  </p>
  <table cellspacing="0" class="dataTable" id="EJHBG" cellpadding="0">
    <thead>
      <tr valign="top" class="stdHeader">
        <td id="colELHBG" width="59%">Criteria</td>
        <td id="colEPHBG" width="23%">Type of Activation</td>
        <td id="colETHBG" width="18%" style="
              border-right: solid 1px #CCCCCC
            ">Number of Computers</td>
      </tr>
    </thead>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">Total number of computers to be activated</p>
      </td>
      <td>
      <p class="lastInCell">N/A</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">Number of computers that will not connect at least once 
      every 180 days</p>
      </td>
      <td>
      <p class="lastInCell">MAK</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">Number of computers in environments where there are 
      less than 25 computers</p>
      </td>
      <td>
      <p class="lastInCell">MAK</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">Number of computers that will regularly connect to the 
      network</p>
      </td>
      <td>
      <p class="lastInCell">KMS</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell">Number of computers in disconnected environments where 
      there are more than 25 computers and no Internet connectivity</p>
      </td>
      <td>
      <p class="lastInCell">KMS</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="evenRecord">
      <td>
      <p class="lastInCell">Number of computers in disconnected environments where 
      there are less than 25 computers and there no Internet connectivity</p>
      </td>
      <td>
      <p class="lastInCell">MAK</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
    <tr valign="top" class="record">
      <td>
      <p class="lastInCell"><b>Remaining computer count should be zero</b></p>
      </td>
      <td>
      <p class="lastInCell">&nbsp;</p>
      </td>
      <td style="
          border-right: solid 1px #CCCCCC
        ">
      <p class="lastInCell">&nbsp;</p>
      </td>
    </tr>
  </table>
  <div class="dataTableBottomMargin">
  </div>
  <p><b>Table 10: Guidance Worksheet</b></p>
</div>
<div style="margin-top: 3px; margin-bottom: 10px">
  <a href="#top">
  <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
  of page</a></div>
<a name="EOJBG"></a>
<h2>Appendix 5: Understanding License States</h2>
<p>Windows Vista utilizes five license states to track activation. The five states 
are Licensed, Initial Grace, non-Genuine Grace, Out of Tolerance Grace, and Unlicensed. 
The term “grace period” refers to a length of time provided to allow any necessary 
actions to return the computer to the licensed state. All grace periods last 30 
days.</p>
<div style="
          width: 295px
        ">
  <img border="0" src="../../../i/mc/cpc/Bottom%20Table/Windows%20Vista/Act12.gif" alt="Figure 8: License States" width="295" height="332"><br>
  <p class="figureCaption"><b>Figure 8: License States</b></p>
  <div class="figureRule">
  </div>
</div>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Licensed: </b>Computers have been properly activated. Activation can happen 
    in several ways including Internet and Phone activation. Additionally, KMS clients 
    can activate themselves after contacting an activated KMS host. </p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Initial Grace (or OOB Grace):</b> Starts the first time you start your 
    computer after you install the operating system. It provides 30 days for the 
    computer to be activated. The initial grace period can only be restarted by 
    running <i>sysprep /generalize</i>, or by using slmgr.vbs –rearm<i>. </i>These 
    processes reset the Initial Grace timer to 30 days. This will only work three 
    times.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Non-Genuine Grace:</b> Occurs only on a computer that has the Windows 
    Genuine ActiveX control installed, and then fails Genuine Validation. The computer 
    is marked non-Genuine, and the License State may be changed to non-Genuine Grace. 
    If this happens, non-Genuine Grace provides 30 days for the computer to be reactivated 
    and validated Genuine by revisiting the WGA website at
    <a href="http://www.microsoft.com/genuine" target="_blank">http://www.microsoft.com/genuine</a>.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Out of Tolerance Grace:</b> Begins when cumulative hardware changes on 
    an activated computer push it beyond a tolerance level, or when a KMS client 
    goes for 180 days without contacting a KMS. OOT Grace provides 30 days for a 
    computer to be reactivated. A computer may be activated and then fall into OOT 
    grace any number of times, and each time the OOT Grace timer will be reset to 
    30 days.</p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p><b>Unlicensed:</b> When any grace period is allowed to expire, the computer 
    becomes Unlicensed. An Unlicensed computer runs in Reduced Functionality Mode 
    (RFM), which provides users very limited access to the system in one-hour increments 
    and presents a window containing links to properly license and activate the 
    computer. If the computer falls into RFM from non-Genuine Grace, the user is 
    presented with a window containing links and solutions specific to recovery 
    from non-Genuine RFM. Further documentation on recovery from RFM is available 
    in the &quot;<a href="#Troubleshooting">Troubleshooting</a>&quot; section earlier in this 
    guide.</p>
    </td>
  </tr>
</table>
<div style="margin-top: 3px; margin-bottom: 10px">
  <a href="#top">
  <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
  of page</a></div>
<a name="EALBG"></a>
<h2>Additional Resources</h2>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>For answers to frequently asked questions about Microsoft Windows Vista Volume 
    Activation 2.0, refer to the &quot;Volume Activation 2.0 FAQ&quot; in
    <a href="http://go.microsoft.com/fwlink/?LinkId=76702" target="_blank">http://go.microsoft.com/fwlink/?LinkId=76702</a></p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>For a list of WMI methods, KMS registry keys, KMS events, KMS error codes, 
    and KMS RPC messages, refer to the &quot;Volume Activation 2.0 Technical Attributes.xls&quot; 
    in <a href="http://go.microsoft.com/fwlink/?LinkId=76703" target="_blank">http://go.microsoft.com/fwlink/?LinkId=76703</a></p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>For information about the Microsoft Solution Accelerator for Business Desktop 
    Deployment (BDD):</p>
    <p><a href="http://go.microsoft.com/fwlink/?LinkId=76620" target="_blank">http://go.microsoft.com/fwlink/?LinkId=76620</a></p>
    </td>
  </tr>
  <tr>
    <td class="listBullet" valign="top">•</td>
    <td class="listItem">
    <p>For a list of Volume License products available, go to:</p>
    <p>
    <a href="http://www.microsoft.com/licensing/default.mspx" target="_blank">http://www.microsoft.com/licensing/default.mspx</a>&nbsp;</p>
    </td>
  </tr>
</table>
<p><br clear="all" style="font-size: 0pt">
</p>
<div style="margin-top: 16px; margin-bottom: 20px; width: 100%">
  <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
      <td><a href="#top">
      <img border="0" src="../../../i/sy/a/12.gif" alt="Top of page" width="7" height="9"></a><a class="topOfPage" href="#top">Top 
      of page</a></td>
    </tr>
  </table>
</div>

</body>

</html>